version: 2

metrics:
  - name: customers_month_start
    label: Total Customers (Month Start)
    model: ref('fct_cloud_subscription_transactions')
    description: >
      The Customers (Logos) of dbt Labs at the start
      of a month (end of previous period).
    tags: ['Company Metric']

    calculation_method: count_distinct
    expression: customer_id

    filters:
      - field: is_last_day_of_month
        operator: "="
        value: "1"

    timestamp: date_day
    time_grains: [month]
    
    dimensions:
      - sales_motion
      - geo_region
      - geo_country
      - geo_state
      - account_region
      - account_subregion
      - market_segment
      - deployment_type

    meta:
      metric_level: 'Company'
      owner(s): 'Andrew Tom'
  