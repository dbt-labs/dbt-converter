version: 2

metrics:
  - name: customers_reactivation_self_serve
    label: Self-Serve Reactivation Customers
    model: ref('fct_customer_activity_self_serve')
    description: >
      The total number of existing Self-Serve customers whose accounts 
      are cancelled (churn to MRR = 0) and then reactivated during a given time period.

    calculation_method: count_distinct
    expression: customer_id

    filters:
      - field: sales_channel
        operator: "="
        value: "'Self-Serve'"
      - field: customer_activity_type
        operator: "="
        value: "'reactivate'"

    timestamp: close_month
    time_grains: [month]

    meta:
      metric_level: 'Company'
      owner(s): 'Paige Berry'
      