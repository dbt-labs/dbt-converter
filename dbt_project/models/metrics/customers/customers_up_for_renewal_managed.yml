version: 2

metrics:
  - name: customers_up_for_renewal_managed
    label: Managed Up for Renewal Customers
    model: ref('fct_customer_activity_managed_quarterly_types')
    description: >
      The total number of existing Managed customers with an open Renew opportunity 
      that has a positive probability (> 0), and the expected Delta ARR is positive or zero (>= 0), 
      indicating a positive (or no) change in ARR (Annual Recurring Revenue) during a given time period.
      {{ doc("customers_counts_managed") }}

    calculation_method: count_distinct
    expression: customer_id

    filters:
      - field: sales_channel
        operator: "="
        value: "'Managed'"
      - field: customer_activity_type
        operator: "="
        value: "'Up for renewal'"
    timestamp: fiscal_year

    dimensions:
      - fiscal_quarter
      - fiscal_year

    meta:
      metric_level: 'Company'
      owner(s): 'Paige Berry'
      