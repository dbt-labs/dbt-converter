version: 2

metrics:

  - name: net_income
    label: Net Income
    model: ref('fct_income_statement_transaction_lines')
    description: "Sales minus cost of goods sold, general expenses, taxes, and interest"

    calculation_method: sum
    expression: round(consolidated_general_rate_net_income_amount,2)

    timestamp: accounting_period_end_date
    time_grains: [month, quarter, year]

    dimensions:
      - subsidiary_name
      - account_full_name
      - department_name
    
    filters:
      - field: accounting_period_end_date
        operator: '<'
        value: CURRENT_DATE()
        
    # general properties
    config:
      treat_null_values_as_zero: true

    meta: {team: Accounting}