version: 2

metrics:
  - name: active_cloud_accounts
    label: Active Cloud Accounts
    model: ref('fct_cloud_account_activities')
    description: > 
      Reports the total number of active (visited a Cloud page) dbt Cloud accounts 
      during the specified time grain.
    tags: []

    calculation_method: count_distinct
    expression: account_id

    timestamp: date_day
    time_grains: [day, week, month, quarter, year]

    filters:
      # Paige / Andrew to switch this when ready
      # - field: is_active
      #   operator: "="
      #   value: "1"
      - field: total_count_pageviews
        operator: ">"
        value: "0"
      - field: is_locked
        operator: "="
        value: "0"


    meta:
      metric_level: 'Company'
      owner(s): 'Andrew Tom'