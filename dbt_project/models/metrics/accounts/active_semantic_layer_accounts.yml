version: 2

metrics:
  - name: active_semantic_layer_accounts
    label: Active Semantic Layer Accounts
    model: ref('fct_cloud_account_activities')
    description: > 
      A measure of semantic layer activity across a dbt Cloud Account, defined as
      whether the Cloud Account ran dbt-sql queries using the semantic layer
    tags: ['Product Metric']

    calculation_method: count_distinct
    expression: account_id

    filters:
      - field: is_semantic_layer_active
        operator: "="
        value: "1"
  
    timestamp: date_day
    time_grains: [day, week, month, quarter, year]

    dimensions:
      - name
      - plan
      - is_active_metrics

    meta:
      metric_level: 'Company'
      owner(s): 'Andrew Tom'