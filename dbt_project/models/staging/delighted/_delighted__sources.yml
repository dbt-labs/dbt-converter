version: 2

sources:
  - name: delighted_dbtcloud_nps
    schema: fivetran_delighted
    database: raw
    description: >
      **Status:** Deprecated - we now use Pendo for product NPS  
        
      {{ doc("src_delighted") }}

    meta:
      team: ['Customer Success']
      owner_name: Estelle Wolski

    loader: fivetran
    loaded_at_field: _fivetran_synced

    tables:
        - name: response
        - name: person

  - name: delighted_thinkific_nps
    schema: fivetran_delighted_thinkific_nps
    loader: fivetran
    loaded_at_field: _fivetran_synced
    database: raw
    description: >
      **Status:** Active  
        
      {{ doc("src_delighted") }}

    meta:
      team: ['Customer Success']
      owner_name: Estelle Wolski

    freshness:
      warn_after: {count: 1, period: day}

    tables:
        - name: response
        - name: person
        - name: response_answer
        - name: question

  - name: delighted_zendesk_csat
    schema: fivetran_delighted_zendesk_csat
    loader: fivetran
    loaded_at_field: _fivetran_synced
    database: raw
    description: >
      **Status:** Active  
        
      {{ doc("src_delighted") }}

    meta:
      team: ['Customer Success']
      owner_name: Estelle Wolski

    freshness:
      warn_after: {count: 1, period: day}

    tables:
        - name: response
          columns:
            - name: properties_zendesk_ticket_id
              tests:
                - not_null
            - name: properties_zendesk_assignee_name
              tests:
                - not_null

        - name: person
        
  - name: delighted_proserv_csat
    schema: fivetran_delighted_proserv_csat
    loader: fivetran
    loaded_at_field: _fivetran_synced
    database: raw
    description: >
      **Status:** Active  
        
      {{ doc("src_delighted") }}

    meta:
      team: ['Customer Success']
      owner_name: Estelle Wolski

    freshness:
      warn_after: {count: 1, period: day}

    tables:
        - name: response
          columns:
            - name: id
              description: Primary key of the response table
              tests:
                - unique
                - not_null
            - name: salesforce_account_id
              description: >
                Customer's SFDC account id as appended to custom survey link via Zapier
        - name: question
        - name: person
        - name: response_answer