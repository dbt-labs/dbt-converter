version: 2

models:
  - name: stg_cloud_stripe__charges
    columns:
      - name: charge_id
        tests:
          - unique
          - not_null
      - name: invoice_total
        description: '{{ doc("stripe_invoice_total") }}'
      - name: refund_total
        description: '{{ doc("stripe_refund_total") }}'

  - name: stg_cloud_stripe__customers
    columns:
      - name: stripe_customer_id
        tests:
          - unique
          - not_null

  - name: stg_cloud_stripe__invoice_line_items
    description: '{{ doc("stripe_invoice_line_items") }}'
    columns:
      - name: unique_id
        description:  Surrogate key consisting of the invoice_id and the invoice_line_item_id.
        tests:
          - unique
          - not_null
      - name: invoice_line_item_id
        description: >
          The identifier of the line item in this invoice (e.g. if it's a subscription item, then it's the subscription item id).
      - name: line_item_type
        description: '{{ doc("line_item_type") }}'
      - name: line_item_subtype
        description: '{{ doc("line_item_subtype") }}'


  - name: stg_cloud_stripe__invoices
    columns:
      - name: invoice_id
        tests:
          - unique
          - not_null
      - name: amount_invoiced
        description: '{{ doc("stripe_amount_invoiced") }}'
      - name: amount_due
        description: '{{ doc("stripe_amount_due") }}'
      - name: invoice_total
        description: '{{ doc("stripe_invoice_total") }}'
      - name: refund_total
        description: '{{ doc("stripe_refund_total") }}'
      - name: is_sales_tax_adjustment
        description: '{{ doc("is_sales_tax_adjustment") }}'
      - name: is_subscription_upgrade
        description: '{{ doc("is_subscription_upgrade") }}'
      - name: is_paid_invoice
        description: '{{ doc("stripe_is_paid_invoice") }}'
      - name: is_closed_invoice
        description: '{{ doc("is_closed_invoice") }}'
      - name: is_charged_invoice
        description: '{{ doc("is_charged_invoice") }}'
      - name: invoice_date
        description: '{{ doc("invoice_date") }}'
      - name: invoice_period_start
        description: '{{ doc("invoice_period_start") }}'
      - name: invoice_period_end
        description: '{{ doc("invoice_period_end") }}'
      - name: stripe_plan_id
        description: '{{ doc("stripe_plan_id") }}'
      - name: stripe_plan_name
        description: '{{ doc("stripe_plan_name") }}'

  - name: stg_cloud_stripe__subscription_changes
    columns:
      - name: unique_id
        tests:
          - unique
          - not_null

  - name: stg_cloud_stripe__subscriptions
    columns:
      - name: subscription_id
        tests:
          - unique
          - not_null