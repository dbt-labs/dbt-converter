version: 2

models:
  - name: stg_salesforce__accounts
    columns:
      - name: account_id
        tests:
          - unique
          - not_null
      - name: account_relationship
        description: "The relationship that an account has to dbt Labs (e.g. Prospect, Partner, etc)."
      - name: dei_research_notes
        description: >
          This is a field in which the DEI stance team documents
          DEI related information about this company.
      - name: is_internal_account
        description: "Flag to indicate if this Salesforce Account is an internal account"
      - name: clearbit_company_type
        description: '{{ doc("clearbit_company_type") }}'
      - name: clearbit_industry
        description: '{{ doc("clearbit_industry") }}'
      - name: clearbit_industry_group
        description: '{{ doc("clearbit_industry_group") }}'
      - name: clearbit_sector
        description: '{{ doc("clearbit_sector") }}'
      - name: clearbit_sub_industry
        description: '{{ doc("clearbit_sub_industry") }}'
      - name: clearbit_year_company_founded
        description: '{{ doc("clearbit_year_company_founded") }}'
      - name: account_status
        description: '{{ doc("account_status") }}'

  - name: stg_salesforce__account_history
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - account_id
            - valid_from

  - name: stg_salesforce__campaign_members
    columns:
      - name: campaign_member_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__campaigns
    columns:
      - name: campaign_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__clearbit
    description: '{{ doc("stg_salesforce__clearbit") }}'
    columns:
      - name: clearbit_id
        tests:
          - unique
          - not_null
      - name: clearbit_company_type
        description: '{{ doc("clearbit_company_type") }}'
      - name: clearbit_industry
        description: '{{ doc("clearbit_industry") }}'
      - name: clearbit_industry_group
        description: '{{ doc("clearbit_industry_group") }}'
      - name: clearbit_sector
        description: '{{ doc("clearbit_sector") }}'
      - name: clearbit_sub_industry
        description: '{{ doc("clearbit_sub_industry") }}'
      - name: clearbit_year_company_founded
        description: '{{ doc("clearbit_year_company_founded") }}'

  - name: stg_salesforce__contacts
    description: '{{ doc("stg_salesforce__contacts") }}'
    columns:
      - name: contact_id
        description: "The unique identifier of a contact"
        tests:
          - unique
          - not_null

      - name: owner_id
        description: "The ID of the owner of the contact. This can be joined to `stg_salesforce__owners` to get the owner details."

      - name: account_id
        description: "The ID of the account the contact is associated with. This can be joined to `stg_salesforce__accounts` to get the account details."

      - name: created_by_id
        description: "The ID of the Salesforce user who created the contact."

      - name: reports_to_id
        description: "The ID of the Salesforce user that the contact reports to."

      - name: current_sequence_owner_id
        description: "The ID of the owner of the sequence the contact is currently in. This is typically an SD or SDR on the Sales team."

      - name: impartner_primary_contact_id
        description: "A lookup field to retrieve the Impartner Contact id"

      - name: qualified_touchpoint_id
        description: "The ID of the most recent qualified touchpoint for a contact. This can be joined to the `stg_salesforce__touchpoints` model to get touchpoint details."

      - name: zendesk_user_id
        description: "The ID of the user in Zendesk."

      - name: initial_sequence_id
        description: "The ID of the first sequence a contact was in."

      - name: current_sequence_id
        description: "The ID of the current sequence a contact is in."

      - name: account_id_from_domain
        description: "The Account ID associated with the contact's email address. This isn't always the same as the Account ID, and therefore the Account ID field is more reliable."

      - name: last_modified_by_id
        description: "The ID of the user who last modified the contact in Salesforce"

      - name: description
        description: "The description of the contact."

      - name: domain_id
        description: "The ID of the domain associated with the contact's email."

      - name: email
        description: "The email address for a contact."

      - name: name
        description: "The full name of a contact."

      - name: first_name
        description: "The first name of a contact."

      - name: last_name
        description: "The last name of a contact."

      - name: title
        description: "The job title for a contact."

      - name: salutation
        description: "The salutation of a contact."

      - name: phone
        description: "The phone number of a contact."

      - name: photo_url
        description: "A URL that links to a photo of a contact."

      - name: linkedin
        description: "A URL that links to a contact's LinkedIn page."

      - name: account_type
        description: "The Account Type for the account the contact is associated with."

      - name: contact_status
        description: >
          The current working status for a contact.
          This is updated by the SDR team as a contact moves through the qualification and promotion process.
          Example values include: new, qualified, assigned, engaging, working, and promoted, among others.

      - name: created_reason
        description: "Indicates if a contact is created as a result of a lead conversion or dbt Cloud sign up."

      - name: lead_source
        description: "The lead source associated with creating the contact."

      - name: how_did_you_hear_about_us
        description: "A free form text field collected on the Contact Sales form."

      - name: city
        description: "The city where the contact lives."

      - name: country
        description: "The country where the contact lives."

      - name: country_code
        description: "The 2 digit Country Code where the contact lives. Examples include: US, GB"

      - name: postal_code
        description: "The postal code where the contact lives."

      - name: state
        description: "The state where the contact lives."

      - name: state_code
        description: "The state code where the contact lives. Examples include: NY, CA"

      - name: street
        description: "The street address where the contact lives"

      - name: region_category
        description: >
          The region where the contact lives.
          This is populated by matching the `country_code` to a region using the `stg_seed__country_to_region` mapping file.

      - name: role
        description: An enrichment field provided by Clearbit that aims to standardize a contact's role within a company. This is based off of the contact's job title.

      - name: sub_role
        description: An enrichment field provided by Clearbit that aims to standardize a contact's role within a company to a specific function. This is based off of the contact's job title.

      - name: seniority
        description: An enrichment field provided by Clearbit that aims to standardize a contact's seniority within a company. This is based off of the contact's job title.

      - name: most_recent_cloud_billing_plan
        description: "Most recent billing plan on the most recently created dbt Cloud User"

      - name: most_recent_cloud_sign_up_at
        description: "Most recent created_at on the most recently created dbt Cloud User"

      - name: most_recent_touchpoint_cloud_billing_plan
        description: "Most recent billing plan on the dbt Cloud Account on the most recently created Sign Up Touchpoint"

      - name: most_recent_touchpoint_cloud_sign_up_at
        description: "Most recent created_at on the dbt Cloud Account on the most recently created Sign Up Touchpoint"

      - name: mmerp__total_emails
        description: "The total number of emails as identified through the Match My Email activity report."

      - name: mmerp__totalrecv
        description: "The total number of emails received from a contact, as identified through the Match My Email activity report."

      - name: mmerp__totalsent
        description: "The total number of emails sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastdirection
        description: "The last direction (sent or received) of an email as identified through the Match My Email activity report."

      - name: mmerp__lastsubject
        description: "The subject line of the last email a contact was included in, as identified through the Match My Email activity report."

      - name: mmerp__firstdatetimesent_at
        description: "A timestamp indicating when an email was first sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstdatetimerecv_at
        description: "A timestamp indicating when an email was first received by a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastdatetimesent_at
        description: "A timestamp indicating when an email was last sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstsubjectrecv
        description: "The subject line of the first email a contact was included in, as identified through the Match My Email activity report."

      - name: mmerp__firstfromsent
        description: "The from name and email of the first email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__responsegap
        description: "The number of hours that have elapsed since an email was received by a user. This is calculated using `mmerp__lastdatetimesent` - `mmerp__lastdatetimerecv`"

      - name: mmerp__lastfrom
        description: "The from name and email on the last email associated with a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastsubjectrecv
        description: "The subject live of the last email received by a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastfromrecv
        description: "The from name and email on the last email received by a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstdirection
        description: "The first direction (sent or received) of an email as identified through the Match My Email activity report."

      - name: mmerp__firstsubject
        description: "The subject line of the first email associated with a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastdatetimerecv_at
        description: "A timestamp indicating when an email was last received from a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstfrom
        description: "The from name and email on the first email associated with a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastdatetime_at
        description: "A timestamp indicating when the last email a contact is associated with occurred, as identified through the Match My Email activity report."

      - name: mmerp__lastfromsent
        description: "The from name and email on the last email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstdatetime_at
        description: "A timestamp indicating when the first email a contact is associated with occured, as identified through the Match My Email activity report."

      - name: mmerp__lastsubjectsent
        description: "The subject line of the last email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstsubjectsent
        description: "The subject line of the first email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstfromrecv
        description: "The from name and email on the first email received by a contact, as identified through the Match My Email activity report."

      - name: current_sequence_name
        description: "The name of the current sequence a contact is in. Sequences are utilized by the SDR team to reach out to contacts that have expressed intersted in our product."

      - name: current_sequence_step_number
        description: "The step number the contact is in within the current sequence."

      - name: current_sequence_step_type
        description: "The step type the contact is in within the current sequence. Examples include manual_email, auto_email, linkedin_send_message, linkedin_send_connection_request, and others."

      - name: current_sequence_task_due_at
        description: "A timestamp indicating when the current sequence is due."

      - name: added_to_current_sequence_at
        description: "A timestamp indicating when a contact was added to the current sequence."

      - name: finished_sequences
        description: "A text field that includes a list of sequences that a contact has been in that are considered finished."

      - name: initial_sequence_name
        description: "The name of the first sequence a contact was included in."

      - name: initial_sequence_at
        description: "A timestamp indicating when a contact was added to their first sequence."

      - name: sequence_to_add_to
        description: "The name of the sequence a contact is expected to be added to."

      - name: current_sequence_owner
        description: "The name of the employee who owns the current sequence a contact is in. This is most frequently an SDR or SD."

      - name: most_recent_touchpoint_source
        description: "The most recent `touchpoint_source` for a given contact."

      - name: most_recent_touchpoint_status
        description: "The most recent `touchpoint_source_status` for a given contact."

      - name: is_deleted
        description: "A boolean field indicating whether or not a contact has been deleted in Salesforce."

      - name: is_email_bounced
        description: "A boolean field indicating if an email bounced when being sent to a contact."

      - name: is_consumer_domain
        description: "A boolean field indicating whether or not a contact's email includes a consumer domain"

      - name: is_actively_being_sequenced
        description: "A boolean field indicating if a contact is currently in a sequence."

      - name: matches_primary_account_domain
        description: "A boolean field indicating if the contact's email domain matches that of their associated account."

      - name: has_opted_out_of_email
        description: "A boolean field indicating if a contact has opted out of receiving emails."

      - name: account_matches_domain_account
        description: "A boolean field indicating if a contact's domain matches that of their associated account."

      - name: is_synced_to_zendesk
        description: "A boolean field indicating if a contact is synced to Zendesk."

      - name: total_emails_outreach
        description: "The total number of emails a contact is included in via Outreach."

      - name: total_emails
        description: "The total number of emails a contact is included in. This includes both MME and Outreach."

      - name: total_recv_emails
        description: "The total number of emails received by a contact. This includes both MME and Outreach."

      - name: total_sent_emails
        description: "The total number of emails sent to a contact. This includes both MME and Outreach."

      - name: number_of_active_sequences
        description: "The total number of sequences a contact is currently in."

      - name: number_of_active_tasks
        description: "The total number of tasks associated with a contact."

      - name: count_of_touchpoints_all_time
        description: "The total number of touchpoints associated with a contact."

      - name: count_of_90d_touchpoints
        description: "The total number of touchpoints associated with a contact that occured in the last 90 days."

      - name: contact_created_at
        description: "A timestamp indicating when a contact was created."

      - name: promoted_at
        description: "A timestamp indicating when a contact was last promoted."

      - name: qualified_at
        description: "A timestamp indicating when a contact was last qualified."

      - name: last_activity_date
        description: "A timestamp indicating when a contact was last active."

      - name: last_modified_date
        description: "A timestamp indicating when a contact was last modified."

      - name: last_referenced_date
        description: "A timestamp indicating when a contact was last referenced."

      - name: last_viewed_date
        description: "A timestamp indicating when a contact was last viewed."

      - name: first_email_at
        description: "A timestamp of the first email a contact was included in."

      - name: last_email_at
        description: "A timestamp of the last email a contact was included in."

      - name: first_recv_email_at
        description: "A timestamp of the first email received from a contact."

      - name: first_recv_email_outreach_at
        description: "A timestamp of the first email received from a contact through Outreach."

      - name: first_sent_email_outreach_at
        description: "A timestamp of the first email sent to a contact through Outreach."

      - name: last_recv_email_outreach_at
        description: "A timestamp of the last email received from a contact through Outreach."

      - name: first_email_outreach_at
        description: "A timestamp of the first email sent to a contact through Outreach"

      - name: total_sent_emails_outreach
        description: "The total number of emails sent to a contact through Outreach."

      - name: total_recv_emails_outreach
        description: "The total number of emails received from a contact through Outreach."

      - name: last_sent_email_outreach_at
        description: "A timestamp of the last email sent to a contact through Outreach."

      - name: last_email_outreach_at
        description: "A timestamp of the last email a contact was included in through Outreach."

      - name: last_sent_email
        description: "A timestamp of the last email sent to a contact."

      - name: last_recv_email
        description: "A timestamp of the last email received from a contact."

      - name: first_sent_email
        description: "A timestamp of the first email sent to a contact."

      - name: system_modstamp
        description: "A timestamp indicating when the record was last modified by a user or an automated process."

  - name: stg_salesforce__cloud_account_mappings
    description: >
      This table is used to map dbt Cloud accounts with a Salesforce Account within Salesforce.
      For more detail on how this is mapped, please view the `int_cloud_account_mappings__stepped` model.
    columns:
      - name: cloud_account_mapping_id
        tests:
          - unique
          - not_null
      - name: account_id
        tests:
          - dbt_utils.relationships_where:
              to: ref('stg_salesforce__accounts')
              field: account_id
              from_condition: "last_modified_at <= dateadd(day,-1,current_date())"
              to_condition: "created_at <= dateadd(day,-1,current_date())"
              
  - name: stg_salesforce__cloud_user_mappings
    description: >
      This table is used to map dbt Cloud users with a Salesforce Contact within Salesforce.
      This is done by matching the email addresses from both sources.
    columns:
      - name: cloud_user_mapping_id
        tests:
          - unique
          - not_null
      - name: contact_id
        tests:
          - dbt_utils.relationships_where:
              to: ref('stg_salesforce__contacts')
              field: contact_id
              from_condition: "last_modified_at <= dateadd(day,-1,current_date())"
              to_condition: "contact_created_at <= dateadd(day,-1,current_date())"

  - name: stg_salesforce__credit_note_items
    columns:
      - name: sfdc_credit_note_item_id
        description: '{{ doc("sfdc_credit_note_item_id") }}'
        tests:
          - unique
          - not_null
      - name: sfdc_credit_note_id
        description: '{{ doc("sfdc_credit_note_id") }}'
      - name: sfdc_product_id
        description: '{{ doc("sfdc_product_id") }}'


  - name: stg_salesforce__credit_notes
    columns:
      - name: sfdc_credit_note_id
        description: '{{ doc("sfdc_credit_note_id") }}'
        tests:
          - unique
          - not_null
      - name: credit_note_name
        description: '{{ doc("credit_note_name") }}'
      - name: credit_note_date
        description: '{{ doc("credit_note_date") }}'
      - name: sfdc_account_id
        description: '{{ doc("sfdc_account_id") }}'
      - name: subtotal_amount
        description: '{{ doc("credit_note_subtotal_amount") }}'
      - name: tax_amount
        description: '{{ doc("credit_note_tax_amount") }}'
      - name: notes
        description: '{{ doc("credit_note_notes") }}'

  - name: stg_salesforce__forecasts
    columns:
      - name: forecast_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__goals
    description: >
      Salesforce Goals are used to compare actuals to targets across several goal types.
      There are currently four types of goals: Leads, Pre-Pipeline, Pipeline, and new Cloud Accounts.
      Leads goals are segmented by Month, Region, Team, Market Segment, and Lead Source.
      Pre-Pipeline & Pipeline goals are segmented by Month, Region, Team, and Market Segment.
      Cloud Accounts are segmented by Month, Region, Market Segment, and Channel.
      Note: Cloud Accounts don't currently have actual values assigned, this is to be updated in early FY 2024.
      Currently, the Operations team updates goals in Salesforce with input from both the Marketing & Revenue teams.
    columns:
      - name: goal_id
        description: A surrogate key created off of the `salesforce_goal_id` and `region` fields.
        tests:
          - unique
          - not_null

      - name: salesforce_goal_id
        description: The Goal identifier in Salesforce.
      
      - name: created_by_id
        description: The identifier of the user who created the goal in Salesforce.

      - name: last_modified_by_id
        description: The identifier of the user who last modified the goal in Salesforce.

      - name: quarter_id
        description: >
          The identifier of the quarter in Salesforce.
          This can be used to join to the `stg_salesforce__quarters` model.

      - name: month_id
        description: >
          The identifier of the month in Salesforce.
          This can be used to join to the `stg_salesforce__months` model.
        
      - name: goal_name
        description: >
          The name of the goal in Salesforce.
          This follows the pattern of: `goal_type`-`year`-`quarter`-`team`-`market_segment`-`touchpoint_source`

      - name: goal_type
        description: >
          The metric that is being goaled against.
          Examples include: Touchpoints, Pre-Pipeline, and pipeline.

      - name: team
        description: >
          The team the goal applies to.
          Examples include: Alliances, Marketing, SD Outbound, SDR Outbound, and Self-Service.
        tests:
          - accepted_values:
              values: ["Alliances", "Marketing", "SD Outbound", "SDR Outbound", "Self-Service"]

      - name: market_segment
        description: >
          The market segment the goal applies to.
          Examples include: Commercial, Enterprise, and Unknown.
        tests:
          - accepted_values:
              values: ["Commercial", "Enterprise", "Unknown"]

      - name: region
        description: >
          The region the goal applies to.
          Examples include: APAC, EMEA, US-Central, US-East, and US-West.
        tests:
          - accepted_values:
              values: ["APAC", "EMEA", "US-Central", "US-East", "US-West", "Unknown"]

      - name: touchpoint_source
        description: >
          The source of the touchpoint that is being goaled.
          Examples include: SA Outbound, Field Marketing, Contact Sales, and Sign Up.

      - name: quarter_name
        description: >
          The quarter the goal applies to.
          This is formatted as YYYY-QQ, for example, 2023-Q4.

      - name: month_name
        description: >
          The month the goal applies to.
          This is formatted as YYYY-MM, for example, 2022-11.

      - name: is_current_month
        description: A boolean that indicates if the goal applies to the current month.

      - name: is_current_quarter
        description: A boolean that indicate if the goal applies to the current quarter.

      - name: is_previous_month
        description: A boolean that indicates if the goal applies to the previous month.

      - name: is_previous_quarter
        description: A boolean that indicates if the goal applies to the previous quarter.

      - name: is_deleted
        description: '{{ doc("is_deleted") }}'

      - name: goal_amount
        description: >
          The goal amount for a given breakdown between its start and end date.
          This is based on a tops-down projection of what we need to generate to hit our plan.
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: forecast_amount
        description: >
          The forecasted amount for a given breakdown between its start and end date.
          This is a bottoms up projection of what we believe we will drive.

      - name: start_date
        description: The first day the goal applies to.

      - name: end_date
        description: The last day the goal applies to.

      - name: quarter_start_date
        description: The first day of the quarter the goal applies to.

      - name: quarter_end_date
        description: The last day of the quarter the goal applies to.

      - name: created_at
        description: A timestamp indicating when the goal was created in Salesforce.

      - name: last_modified_at
        description: A timestamp indicating when the goal was last modified by a user in Salesforce.
      
      - name: system_modstamp
        description: '{{ doc("system_modstamp") }}'

  - name: stg_salesforce__events
    columns:
      - name: salesforce_event_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__gong_calls
    columns:
      - name: gong_call_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__invoices
    columns:
      - name: invoice_id
        tests:
          - unique
          - not_null
      - name: invoice_status
        description: '{{ doc("invoice_status") }}'

  - name: stg_salesforce__months
    description: >
      This model includes 1 row per month from the Salesforce Month object.
      For the most part, this is used as a lookup table to other models (by joining on `month_id`) to retreive the month values, start_date, and end_date.
    columns:
      - name: month_id
        tests:
          - unique
          - not_null

      - name: quarter_id
        description: >
          The ID of the quarter from Salesforce.
          This maps to the Quarter object in Salesforce, and the `stg_salesforce__quarters` model in our project.

      - name: created_by_id
        description: >
          The ID of the user who created the month.
          This maps to the User object in Salesforce, and the `stg_salesforce__users` model in our project.

      - name: last_modified_by_id
        description: >
          The ID of the user who last modified the month.
          This maps to the User object in Salesforce, and the `stg_salesforce__users` model in our project.

      - name: month_name
        description: >
          The name of the month.
          This follows the format: `YYYY-MM`

      - name: is_deleted
        description: A boolean field (true/false) that indicates if the month is deleted.

      - name: is_current_month
        description: A boolean field (true/false) that indicates if the month is the current month.

      - name: is_previous_month
        description: A boolean field (true/false) that indicates if the month is the previous month.

      - name: start_date
        description: The first day of the month.

      - name: end_date
        description: The last day of the month.

      - name: created_at
        description: A timestamp indicating when the month was created.

      - name: last_modified_at
        description: A timestamp indicating when the month was last modified.

  - name: stg_salesforce__opportunities
    columns:
      - name: opportunity_id
        tests:
          - unique
          - not_null
      - name: partner_manager_id
        description: >
            The Salesforce user identifier of the partner manager assigned to the opportunity. 
            Consulting partners are typically managed by a single partner manager, 
            but some consulting partners span regions. This field enables dbt to override 
            the default partner manager and split up work across multiple partner managers.
      - name: sa_next_steps
        description: The opportunity's next steps from the SA side.

  - name: stg_salesforce__opportunity_contact_roles
    description: >
      One row per contact per opportunity.
      An opportunity contact is someone who is directly associated with an opportunity.
      This models allows us to identify those contacts.
    columns:
      - name: opportunity_contact_role_id
        description: A unique identifier per contact per opportunity
        tests:
          - unique
          - not_null
      - name: contact_id
        description: The Contact's unique ID.
      - name: created_by_id
        description: The unique ID of the User who created the Contact Role.
      - name: last_modified_by_id
        description: The unique ID of the User who last modified the Contact Role.
      - name: opportunity_id
        description: The ID of the Opportunity associated with the Contact Role.
      - name: contact_role  
        description: >
          The role of the Contact on the Opportunity.
          Examples include: Champion, Evalutor, Influencer, among others.
      - name: is_deleted
        description: A boolean field that indicates if the Contact Role is deleted or not.
      - name: is_primary
        description: A boolean field indiciating if the Contact is the primary Contact on the Opportunity.
      - name: created_at
        description: A timestamp indicating when the Contact Role was created.
      - name: last_modified_at
        description: A timestamp indicating when the Contact Role was last modified.
      - name: system_modstamp
        description: A timestamp indicating when the Contact Role was last modified by a user or an automated process.

  - name: stg_salesforce__opportunity_forecasts
    columns:
      - name: opp_forecast_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__opportunity_history
    columns:
      - name: opportunity_history_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__opportunity_line_items
    description: >
      This model contains 1 row per line item in an opportunity.
      A line item is a specific product included in a deal with an Enterprise customer.
      Examples of line items include, but are not limited to: Develop Licenses, Rapid Onboarding Hours, or Single Tenant Deployments.
      This information can be used to understand how much revenue each individual product is contributing to our business.
      This data can be joined to Salesforce Opportunities using the `opportunity_id` field to further filter or segment this data to relevant deals.
    columns:
      - name: opportunity_line_item_id
        description: The unique identifier for the opportunity line item.
        tests:
          - unique
          - not_null

      - name: created_by_id
        description: The ID of the user who created the line item.

      - name: opportunity_id
        description: The ID of the opportunity the line item is associated with.

      - name: pricebook_entry_id
        description: The pricebook entry identifier.

      - name: product_id
        description: >
          The product identifier.
          This can be joined to `stg_salesforce__products` to retrieve additional product information.

      - name: last_modified_by_id
        description: The ID of the user who last modified the line item.

      - name: sbqq_quote_line_id
        description: The ID of the Salesforce CPQ quote line item.

      - name: services_delivered_by_id
        description: The person (instructor or proserv analytics engineer) that delivered the service.

      - name: line_item_name
        description: >
          The name of the line item.
          This is known as "Opportunity Product" in the user interface.
          This follows the pattern of "`Account Name` - `Opportunity Type` `Product Name`".

      - name: product_name
        description: >
          The name of the product associated with the line item.
          Examples include: Devlop License, Service Hour, etc.

      - name: product_code
        description: '{{ doc("sfdc_product_code") }}'

      - name: line_description
        description: >
          A description of the line item as entered in Salesforce.
          This is used to provide any additional information that should be known about a line item.

      - name: unit
        description: >
          This field specifies the quantity unit of measure for the line item.
          Examples include: Each, License, Hours, Deployment, and Course.

      - name: quantity
        description: >
          The number of units contained within a line item.
          For example, 50 develop licenses would contain a quantity of 50.

      - name: sort_order
        description: >
          Number indicating the sort order selected by the user.
          This is used to match the sort order in our models to the Salesforce UI.

      - name: subscription_type
        description: >
          The type of subscription the line item adheres to.
          Examples include: Renewable, One-Time, and Evergreen.

      - name: is_on_prem
        description: >
          A boolean field indicating if the line item `product_code` contains `deployment_vpc`.

      - name: is_service_hour
        description: >
          A boolean field indicating if the line item `product_code` contains `service_hour`.

      - name: was_created_after_close_date
        description: A boolean field indicating if the line item was created after the deal closed.

      - name: is_rapid_onboarding_ps_ticket_created
        description: >
          A boolean indicating if Professional Services / Training documentation have been created.
          Connected to a zap that will create the documentation if none exist.

      - name: discount_pct
        description: The discount for the line item as a percentage.

      - name: list_price
        description: '{{ doc("list_price") }}'

      - name: total_price
        description: >
          The total price of the line item with discounts included.
          This is calculated as `unit_price` * `quantity` * (1 - `discount_pct`).

      - name: unit_price
        description: >
          The total price per unit within a line item.
          This is calculated as `total_price` / `quantity`.

      - name: mrr
        description: The monthly revenue amount for the line item.

      - name: arr
        description: The annual revenue amount for the line item.

      - name: rate
        description: >
          The actual price of the unit contained in the line item.
          For example, if the line item contains 50 develop licenses, this would equate to the cost per license.

      - name: subtotal_amount
        description: >
          The total price of the line item before discounts.
          This is calculated as `unit_price` * `quantity`.

      - name: charge_type
        description: >
          The cadence in which the line item will be charged.
          Examples include: Recurring and One-Time.

      - name: scheduling_notes
        description: A open-text field that provides context to any scheduling of rapid onboarding line items.

      - name: quantity_used
        description: >
          This field is specific to rapid onboarding line items.
          It explains how many onboarding sessions have been used.
          This field is manually entered by the ProServe team.

      - name: quantity_scheduled
        description: >
          This field is specific to rapid onboarding line items.
          It explains how many onboarding sessions have been scheduled.
          Refer to the `scheduling_notes` field to see more details.
          This field is manually entered by the ProServe team.

      - name: quantity_deferred
        description: >
          This field is specific to rapid onboarding line items.
          It explains how many rapid onboarding have been deferred (won't be used).
          This field is manually entered by the ProServe team.

      - name: usage_status
        description: >
          Will be `Scheduled` if some units have been scheduled, `Delivered` if all units have been used, or otherwise `Null`.

      - name: duration
        description: >
          The number of months the line item is purchased for.
          This value can be a decimal to appropriately pro-rate the deal.
          For a 12-month deal, this value will be 12.
          For expand deals, this might be the number of months left in the existing deal with proration, for example 2.3

      - name: time_unit
        description: >
          The unit of time in which the product is sold for.
          Examples include Month, Year, and None.

      - name: rapid_onboarding_length
        description: "The type of rapid onboarding purchased: 1 session per week for six weeks or 2 sessions per week for three weeks."
        tests:
          - accepted_values:
              values: ["3 week", "6 week"]

      - name: desired_start_date
        description: >
          The desired start date for a rapid onboarding product.

      - name: service_date
        description: >
          A timestamp indicating when service for the line item begins.

      - name: services_kicked_off_date
        description: The Monday of the week that the Professional Service engagement begins.

      - name: services_delivered_date
        description: The Monday of the week that the Professional Service engagement ends.

      - name: starts_on
        description: >
          A timestamp indicating when the line item is available to the customer.

      - name: ends_on
        description: >
          A timestamp indicating when the line item is no longer available to the customer.

      - name: last_modified_at
        description: A timestamp indicating when the line item was last modified.

      - name: created_at
        description: A timestamp indicating when the line item was created.

      - name: system_modstamp
        description: A timestamp indicating when the line item was last modified by a user or an automated process.

  - name: stg_salesforce__opportunity_stages
    columns:
      - name: opportunity_stage_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__order_items
    columns:
      - name: sfdc_order_item_id
        tests:
          - unique
          - not_null

      - name: sfdc_order_id
        description: '{{ doc("sfdc_order_id") }}'

  - name: stg_salesforce__orders
    columns:
      - name: sfdc_order_id
        description: '{{ doc("sfdc_order_id") }}'
        tests:
          - unique
          - not_null
      - name: order_number
        description: '{{ doc("order_number") }}'

  - name: stg_salesforce__owners
    columns:
      - name: owner_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__partner_influences
    description: "This table signifies every time a partner sources or influences an opportunity (whether it is sourced or influenced)."
    columns:
      - name: partner_influence_id
        tests:
          - unique
          - not_null
      - name: partner_influenced_open_pipeline
        description: "The total revenue that the partner influenced if the opportunity is currently active and in pipeline."
      - name: partner_influenced_revenue
        description: "The total potential revenue that the partner influenced for this opportunity (regardless of opp's current status)."
      - name: partner_influenced_won_arr
        description: "The total won revenue that the partner influenced."

  - name: stg_salesforce__partners
    columns:
      - name: partner_id
        tests:
          - unique
          - not_null
      - name: primary_domain
        tests:
          - not_null

  - name: stg_salesforce__products
    columns:
      - name: product_id
        tests:
          - unique
          - not_null
      - name: product_name
        tests:
          - not_null
      - name: credit_note_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: credit_note_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: invoice_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: invoice_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: payment_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: payment_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: refund_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: refund_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: rev_rec_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: rev_rec_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

  - name: stg_salesforce__rep_quota_periods
    columns:
      - name: rep_quota_period_id
        tests:
          - unique
          - not_null

      - name: commission_period_id
        description: "The identifier of the commision period"

      - name: sales_person_id
        description: "The foreign key for the sales person in the Salesforce `Sales Person` table."

      - name: sales_person_user_id
        description: "The foreign key for the sales person's Salesforce user_id."

      - name: rep_quota_period
        description: "The quota period and the attributed sales person (e.g. August 2022 - Cookie Monster)."

      - name: sales_person_name
        description: "The name of the sales person responsibile for the quotas."

      - name: sales_person_role
        description: "The role of the sales person (e.g. Solutions Architect, Sales Director, etc)"

      - name: total_quota
        description: "The total quota (new arr quota + renewal quota) the sales person is required to hit during this commission period"

      - name: total_delta_arr
        description: "The revenue that counts towards the company net ARR goal. This field only looks at delta ARR associated with the SDs."

      - name: total_rep_delta_arr
        description: "The delta ARR associated with the sales person."

      - name: total_services_revenue
        description: "Services revenue closed in that period (Revenue for onboarding, PS hours, etc. that do not count towards ARR)"

      - name: total_opp_commissions
        description: "The number of commission records on the period (correlates to the number of deals closed / the sales person is getting credit for)"

  - name: stg_salesforce__rev_distribution_method
    columns:
      - name: sfdc_rev_distribution_method_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__rev_finance_period
    columns:
      - name: sfdc_rev_finance_period_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__rev_rec_treatment
    columns:
      - name: sfdc_rev_rec_treatment_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__rev_schedules
    columns:
      - name: sfdc_rev_schedule_id
        tests:
          - unique
          - not_null
      - name: revenue_schedule_code
        description: '{{ doc("revenue_schedule_code") }}'

  - name: stg_salesforce__quarters
    columns:
      - name: quarter_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__tasks
    columns:
      - name: salesforce_task_id
        tests:
          - unique
          - not_null
      - name: combined_email_direction
        description: The combined values from mme__emaildirection and email_direction

  - name: stg_salesforce__touchpoints
    description: '{{ doc("stg_salesforce__touchpoints") }}'
    columns:
      - name: touchpoint_id
        description: "The unique identifier for the touchpoint."
        tests:
          - unique
          - not_null

      - name: account_id
        description: "The Salesforce Account id"

      - name: campaign_id
        description: >
          The ID of the Salesforce campaign that created that touchpoint.
          This will only populate if the touchpoint was created as a part of a campaign.
        
      - name: contact_id
        description: "The Salesforce Contact id"

      - name: created_by_id
        description: "The id of the user who created the Touchpoint"

      - name: cloud_user_account_mapping_id
        description: "A lookup id to retrieve the Cloud user account from the dbt Cloud User Account object in Salesforce. NOTE: This is not the same as the dbt Cloud User Account id from our product."

      - name: cloud_account_mapping_id
        description: "A lookup id to retrieve the Cloud account from the dbt Cloud Account object in Salesforce. NOTE: This is not the same as the dbt Cloud Account id from our product."

      - name: cloud_user_mapping_id
        description: "A lookup id to retrieve the Cloud user from the dbt Cloud User object in Salesforce. NOTE: This is not the same as the dbt Cloud User id our product."

      - name: impartner_partner_account_id
        description: "Entered in Impartner; dbt Cloud Account ID associated with a Partner Project"

      - name: last_modified_by_id
        description: "The id of the user who last modified the touchpoint."

      - name: opportunity_id
        description: "The id of the opportunity associated with the touchpoint."

      - name: owner_id
        description: "The id of the user who owns the touchpoint. This is often the Sales Director (SD) or Sales Development Representative (SDR)."

      - name: referred_by_partner_contact_id
        description: "The contact id of the partner that referred the touchpoint."

      - name: referred_by_partner_id
        description: "The partner id of the partner that referred the touchpoint."

      - name: zendesk_ticket_id
        description: "The id of the zendesk ticket that resulted in the touchpoint. This is derived from `Support Request` touchpoints."

      - name: impartner_deal_registration_status
        description: "Used in Impartner; Formula field that sets the Status to Approved, Pending, or Denied"

      - name: impartner_type_of_dbt_project
        description: "Entered in Impartner when impartner_type_of_registration is dbt Project; contains values of dbt Core and dbt Cloud"

      - name: impartner_type_of_registration
        description: "Entered in Impartner; Maps to Source and contains the values of dbt Project and dbt Cloud Enterprise sales referral"

      - name: message
        description: "An open text field that provides additional context to a touchpoint. This is only populated for touchpoints where open text is available, such as contact sales email, support request, and email introductions."

      - name: touchpoint_name
        description: "The touchpoint name derived from Salesforce. This follows the format of: L-#########"

      - name: touchpoint_source_detail
        description: "Additional detail that provides context to the touchpoint. An example includes the name of the Webinar that resulted in a Webinar touchpoint."

      - name: touchpoint_source_type
        description: "Synonymous with team: this is the team that is responsible for the touchpoint."

      - name: touchpoint_source
        description: "The source of the touchpoint. Examples include Contact Sales, Sign Up, SDR Outbound, etc."

      - name: touchpoint_status
        description: "The current status of the touchpoint. Examples include New, Promoted, Working - Reached Out, and Archived."

      - name: is_deleted
        description: "A boolean field (true/false) that indicates if the touchpoint is deleted."

      - name: is_impartner_deal_registration
        description: "Set to true for Touchpoints that come in via Impartner"

      - name: is_impartner_deal_registration_denied
        description: "Used in Impartner; Manually checked if the partner team denies a Touchpoint entered by a Partner"

      - name: is_impartner_notify_partner
        description: "Used in Impartner; Set to true to trigger a notification to the partner"

      - name: is_qualified_touchpoint
        description: "A boolean field (true/false) that indicates if the touchpoint resulted in a contact becoming qualified."

      - name: created_at
        description: "A timestamp of when the touchpoint was created."

      - name: last_activity_at
        description: "A timestamp of when the touchpoint was last active."

      - name: last_modified_at
        description: "A timestamp of when the touchpoint was last modified."

      - name: last_viewed_at
        description: "A timestamp of when the touchpoint was last viewed."

      - name: last_referenced_at
        description: "A timestamp of when the touchpoint was last referenced."

      - name: opened_at
        description: >
          A timestamp indicated when the touchpoint was opened.
          This is the standard field that should be used when analyzing touchpoints for a given timeframe.
          This field is different than `created_at` in that it can be adjusted after the fact, resulting in more accurate values.

      - name: qualified_at
        description: >
          A timestamp indicated when the touchpoint resulted in a qualified contact.
          This field is a combination of the `opened_at` field and the `is_qualified_touchpoint` field.

      - name: system_modstamp
        description: "A timestamp indicating when the record was last modified by a user or an automated process."

  - name: stg_salesforce__quotes
    columns:
      - name: quote_id
        tests:
          - unique
          - not_null

  - name: stg_salesforce__territories
    columnns:
      - name: territory_id
        tests:
          - not_null
          - unique

      - name: territory_name
        description: The name of the sales territory.

      - name: territory_theater
        description: >
          The broadest grouping of a territory.
          Examples include: US, EMEA, and APAC.
          This is largely used to for account reassignment rules in Salesforce.

      - name: territory_region
        description: >
          The region of the territory.
          Examples include: APAC-ANZ, APAC-Asia, and US-West.
          Note: this is not the same as account regions, and is largely used for account reassignment rules in Salesforce.

  - name: stg_salesforce__territory_countries
    description: >
      This model includes 1 row per country that is associated with a Sales territory.
      This is used downstream to bring territory information into non-salesforce models that include country names.
    columns:
      - name: territory_country_id
        description: The unique ID of the country.
        tests:
          - unique
          - not_null

      - name: created_by_id
        description: The ID of the user who created the territory country.

      - name: external_id
        description: An external identifier used to lookup territory countries in Salesforce.

      - name: last_modifieid_by_id
        description: The ID of the user who last modified the territory country.

      - name: new_territory_id
        description: The ID of the new territory the country maps to.

      - name: owner_id
        description: The ID of the user who owns the territory country.

      - name: territory_id
        description: The ID of the territory the country maps to.

      - name: country_name
        description: The name of the country.

      - name: count_of_states_or_provinces
        description: >
          The number of states and/or provinces associated with the country.
          These can be found in the `stg_salesforce__territory_states` model.

      - name: is_deleted
        description: A boolean that indicates whether the territory country is deleted or not.

      - name: created_at
        description: A timestamp indicating when the territory country was created.

      - name: last_modified_at
        description: A timestamp indicating when the territory country was last modified.

      - name: system_modstamp
        description: '{{ doc("system_modstamp") }}'

  - name: stg_salesforce__territory_states
    description: >
      This model includes 1 row per State and/or Province that is associated with a territory.
      This is used downstream to bring territory information into non-salesforce models that include state or province names.
    columns:
      - name: territory_state_id
        description: The unique ID of the state and/or province.

      - name: created_by_id
        description: The ID of the user who created the territory country.

      - name: external_id
        description: >
          An external identifier used to lookup territory countries in Salesforce.
          This follows the format of: `country_name` - `state_province`.

      - name: last_modifieid_by_id
        description: The ID of the user who last modified the territory country.

      - name: new_territory_id
        description: ""

      - name: previous_territory_id
        description: ""

      - name: territory_id
        description: The ID of the territory the state and/or province maps to.

      - name: territory_country_id
        description: The ID of the territory country the state and/or province maps to.

      - name: state_province
        description: The name of the state and/or province.

      - name: count_of_zip_or_postal_codes
        description: >
          The number of zip or postal codes that map to the state and/or province.
          These can be found in the `stg_salesforce__territory_zipcodes` model.

      - name: is_deleted
        description: A boolean that indicates whether the territory country is deleted or not.

      - name: created_at
        description: A timestamp indicating when the territory country was created.

      - name: last_modified_at
        description: A timestamp indicating when the territory country was last modified.

      - name: system_modstamp
        description: '{{ doc("system_modstamp") }}'

  - name: stg_salesforce__territory_zipcodes
    description: >
      This model includes 1 row per zip or postal code that is associated with a Sales territory.
      This is used downstream to bring territory information into non-salesforce models that include zip or postal codes.
    columns:
      - name: territory_zipcode_id
        description: The unique ID of the zip or postal code.

      - name: created_by_id
        description: The ID of the user who created the territory country.

      - name: external_id
        description: >
          An external identifier used to lookup territory countries in Salesforce.
          This follows the format of `country_name` - `zipcode`.

      - name: last_modifieid_by_id
        description: The ID of the user who last modified the territory country.

      - name: new_territory_id
        description: ""

      - name: previous_territory_id
        description: ""

      - name: territory_id
        description: The ID of the territory the zip or postal code maps to.

      - name: territory_state_id
        description: The Id of the state and/or province the zip or postal code maps to.

      - name: city
        description: The name of the city associated with teh zip or postal code.

      - name: zipcode
        description: The zip or postal code.

      - name: is_deleted
        description: A boolean that indicates whether the territory country is deleted or not.

      - name: created_at
        description: A timestamp indicating when the territory country was created.

      - name: last_modified_at
        description: A timestamp indicating when the territory country was last modified.

      - name: system_modstamp
        description: '{{ doc("system_modstamp") }}'

  - name: stg_salesforce__credentials
    description: >
      The Salesforce credential object used for assigning achieved dbt credentials to partners. This data originates in
      `export_partner_certifications` and is synced to SFDC via Hightouch, where it is manually currated. The fields are 
      intentionally limited to avoid redundancy.
    columns:
      - name: credential_exam_id
        tests:
          - not_null
          - unique
      - name: partner_id

  - name: stg_salesforce__job_requisitions
    columnns:
      - name: job_requisition_id
        tests:
          - not_null
          - unique

  - name: stg_salesforce__crossbeam_overlap
    description: >
      The Salesforce Crossbeam Overlap model is used to show where we have account overlaps with our Partners. It shows which customers and prospects
      we have in common with our various technology and services partners.
    columns:
      - name: crossbeam_overlap_id
        tests:
          - not_null
          - unique
      - name: salesforce_account_id
        description: "The Salesforce Account ID in our Salesforce instance that the partner overlap is related to."
      - name: partner_account_name
        description: "The name of the account in our partner's Salesforce instance."
      - name: partner_contact_email
        description: "The primary contact in our partner's organization for this relationship"
      - name: parter_ae_name
        description: "The account executive at our partner's organization that owns the account"
      - name: partner_ae_phone
        description: "The phone number of the account executive at our partner's organization that owns the account"
      - name: partner_name
        description: "The name of our partner"
      - name: partner_population
        description: "The population that this account falls into in our partner's database. Examples include Customer or Prospect"
      - name: dbt_population
        description: "The population that this account falls into in our database. Examples include Customer or Prospect"