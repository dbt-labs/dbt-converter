version: 2

models:

- name: metadata_account_usage
  description: >
    Summary of metadata feature usage at the account level. This table is here
    to reduce the computational load in `fct_cloud_accounts`. This intermediate
    table can be used in other downstream models too.
  columns:
  - name: account_id
    tests:
    - unique
    - not_null
  - name: total_external_metadata_api_requests
    description: >
      '{{ doc('total_external_metadata_api_requests') }}'
  - name: has_external_metadata_api_requests
    description: >
      '{{ doc('has_external_metadata_api_requests') }}'

- name: metadata_daily_user_activity
  description: >
    Summary of metadata feature usage at the daily user level. This table is 
    here to reduce the computational load in `fct_cloud_user_account_activities`. 
    This intermediate table builds up to `metadata_account_usage`.
  columns:
  - name: id
    tests:
    - unique
    - not_null
  - name: total_external_metadata_api_requests
    description: >
      '{{ doc('total_external_metadata_api_requests') }}'
  - name: source_count
    description: A count of the distinct sources of metadata api calls. 