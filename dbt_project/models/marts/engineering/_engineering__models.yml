version: 2

models:
  - name: fct_datadog_requests
    description: >
      Daily application request availability calculations for AWS singletenant
      and AWS multitenant Datadog instances.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - dbt_instance
            - requests_date
    columns:
      - name: instance_type
        description: The associated Datadog instance
        tests:
          - accepted_values:
              values: ['multitenant', 'singletenant']
      - name: dbt_instance
        description: >
          The dbt Cloud instance: one of `prod-us`, `prod-emea`, or `prod-au`
          for multitenant or the client's application name for singletenant.
      - name: requests_date
        description: Day in UTC
      - name: daily_requests_total
        description: Count of all requests to the instance
      - name: elb_error_requests_total
        description: Count of all ELB error requests to the instance
      - name: target_error_requests_total
        description: Count of all target error requests to the instance
      - name: percent_successful_requests
        description: The calculated availability % of requests