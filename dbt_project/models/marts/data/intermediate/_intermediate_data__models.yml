version: 2

models:
  - name: int_production_model_wh_recommendations_stats
    description:
      Min, median, max, mode of warehouse recommendations.
  - name: int_production_model_wh_recommendations
    description: >
      Snowflake warehouse-size recommendations by model and materialization
      strategy using data from the last six months of Snowflake query history.
      The recommedation tiers applied were sourced from [GitLab's open-sourced
      model materialization reccomendations](https://about.gitlab.com/handbook/business-technology/data-team/platform/dbt-guide/#model-size).
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - dbt_model_name
            - dbt_materialization_type
            - is_incremental_full_refresh
            - warehouse_size_numeric
  - name: int_production_queries_aggregated_by_model
    description: >
      Aggregation of Snowflake query statistics to the dbt model grain.
      This model features the most recent 100 runs per unique combinatin of: dbt_model_name, dbt_materialization_type, is_incremental_full_refresh, and warehouse_size_numeric.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - dbt_model_name
            - dbt_materialization_type
            - is_incremental_full_refresh
            - warehouse_size_numeric
  - name: int_snowflake_amortized_rates
    description: >
      One row per day with the snowflake credit spend for that day, based off
      of our Snowflake credit contractual rate.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_day
            - rate