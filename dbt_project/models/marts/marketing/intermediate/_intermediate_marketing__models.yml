version: 2

models:
  - name: int_linkedin_ads__creative_enriched
    description: >
      The latest version of a LinkedIn Ads creative.
      This model provides additional information that can not be obtained via the LinkedIn Ads package from Fivetran.
      Specifically, it enriches Sponsored Update creatives with the landing page URL from the `share_history` table from the LinkedIn Organic dataset.
      This is possibly since every sponsored update is originally a shared piece of content.
    columns:
      - name: creative_id
        description: Unique internal ID representing the creative.
        tests:
          - not_null

      - name: last_modified_at
        description: The timestamp of when the version was updated.

      - name: created_at
        description: The timestamp of when the creative was created.

      - name: campaign_id
        description: The ID of the campaign the creative belongs to.

      - name: share_id
        description: >
          The ID of the share the creative is associated with.
          This is required to bring in the landing page URL of that share into the ad model.

      - name: status
        description: '{{ doc("linkedin_ads_status") }}'

      - name: click_uri
        description: '{{ doc("linkedin_ads_click_uri") }}'

      - name: base_url
        description: >
          The base URL of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: url_host
        description: >
          The URL host of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: url_path
        description: >
          The URL path of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: utm_source
        description: >
          The utm_source parameter of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: utm_medium
        description: >
          The utm_medium parameter of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: utm_campaign
        description: >
          The utm_campaign parameter of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: utm_content
        description: >
          The utm_content parameter of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: utm_term
        description: >
          The utm_term parameter of the ad, extracted from the `click_uri`.
          For sponsored update ads, this is populated via the landing page URL from the `share_history` table.

      - name: is_latest_version
        description: >
          Boolean of whether the record is the latest version of the cretive.
          Note: this table is filtered to only include the latest version.

  - name: int_marketing_funnel_events_joined
    description: This dataset includes one row per unique combination of account, contact, lead & opportunity. The purpose of this model is to track every sequence in which a user makes their way through the funnel.
    columns:
      - name: user_funnel_id
        description: A surrogate key created based on contact_id and touchpoint_id. This represents each unique funnel for a given contact.
        tests:
          - unique
          - not_null

      - name: account_id
        description: The Salesforce account associated with this sequence.

      - name: contact_id
        description: The Salesforce contact associated with this sequence.

      - name: touchpoint_id
        description: The Salesforce lead associated with this sequence.

      - name: opportunity_id
        description: The Salesforce opportunity associated with this sequence.

      - name: touchpoint_source
        description: The hand raise event that converted a contact into a lead.

      - name: touchpoint_index
        description: This nth hand raise event for a given contact. The lead index starts at 1 (first hand raise event).

      - name: campaign_sources
        description: The marketing campaign(s) that brought this contact into Salesforce.

      - name: contact_created_at
        description: A timestamp indicating when a contact was first entered into Salesforce.

      - name: touchpoint_opened_at
        description: A timestamp indicating when a hand raise event occured.

      - name: opportunity_created_at
        description: A timestamp indicating when a lead is promoted to an opportunity.

      - name: opportunity_discovered_at
        description: A timestamp indicating when an opportunity enters the "discover" stage of the pipeline.

      - name: opportunity_won_at
        description: A timestamp indicating when an opportunity reached the "closed won" stage of the pipeline.
