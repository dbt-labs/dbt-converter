version: 2

models:
  - name: dim_salesforce_accounts
    columns:
      - name: account_id
        description: '{{ doc("sfdc_account_id") }}'
        tests:
          - unique
          - not_null
      - name: account_status
        description: '{{ doc("account_status") }}'
      - name: clearbit_company_type
        description: '{{ doc("clearbit_company_type") }}'
      - name: clearbit_industry
        description: '{{ doc("clearbit_industry") }}'
      - name: clearbit_industry_group
        description: '{{ doc("clearbit_industry_group") }}'
      - name: clearbit_sector
        description: '{{ doc("clearbit_sector") }}'
      - name: clearbit_sub_industry
        description: '{{ doc("clearbit_sub_industry") }}'
      - name: clearbit_year_company_founded
        description: '{{ doc("clearbit_year_company_founded") }}'
      - name: account_segmentation
        description: '{{ doc("account_segmentation") }}'
      - name: zoominfo_industry
        description: ZoomInfo top-level industry classification for a company
      - name: zoominfo_company_revenue
        description: ZoomInfo company revenue in raw number (e.g., 400 million is expressed as 400000000)
      - name: customer_references
        description: A list of references the account has agreed to allow us to use. Examples include Logo Rights, Refer to Company Name, Customer Quote, and Case Study.
      - name: customer_reference_contact_email
        description: The email of the person who should be contacted in regards to customer references
      - name: hq_territory_country
        description: The country in which the account's headquarters is located
      - name: landed_at
        description: The start date of the accounts first contract
      - name: client_technical_contact_id
        description: The contact ID of the main point of contact for the customer
      - name: client_technical_contact_name
        description: The name of the main point of contact for the customer
      - name: client_technical_contact_email
        description: The email of the main point of contact for the customer
      - name: became_customer_on
        description: >
          The `won_at` date associated with the account's first won opportunity.
      - name: landed_at
        description: >
          The `contract_start_date` associated with the account's first won opportunity.
      - name: days_to_renewal
        description: >
          If this account is a customer, then this takes the contract end date (i.e. `current_term_end`)
          and calculates how far we are from their renewal date starting _today_.
      - name: business_case_overview_video_url
        description: >
          A link to a Loom video explaining the use case for dbt for an account.
          This can be used to get a quick overview of why an account has a need for dbt, as well as some qualitative information from the sales team regarding the use case.
          This value is pulled from the most recent opportunity where this value exists (most recent = latest `created_at`).
      - name: bi_analytics_tools
        description: >
          A list of the current BI tools an Account is using.
          This value is derived from a multi-picklist field in Salesforce, and is filled out by the SA/SD during the technical win flow.
          If the value in this field is "Other", then the value is stored in `bi_analytics_tools_other`.
      - name: bi_analytics_tools_other
        description: >
          A free-form text field to specify any BI tools an Account is using outside of those in `bi_analytics_tools`.
          This is filled out by the SA/SD during the technical win flow.
      - name: current_data_transformation_tool
        description: >
          The current data transformation tool an Account is using.
      - name: data_warehouse
        description: >
          The data warehouse that an Account is using.
          Examples include: Snowflake, BigQuery, Databricks - among others.
      - name: data_warehouse_access
        description: >
          The type of access required for the Account's data warehouse.
          Examples include: Accessible over public Internet and Not accessible over Internet.
      - name: git_provider
        description: >
          The git provider the Account uses.
          Examples include: GitHub, GitLab, Azure DevOps - among others.
      - name: git_provider_access
        description: >
          The type of access required for the Account's Git provider.
          Examples include: Accessible over public Internet and Not accessible over Internet.
      - name: identity_provider
        description: >
          The Identity Provider that the Account uses.
          Examples include: Okta, Azure AD, Google Cloud Identity, SAML 2.0 - among others.
      - name: number_of_verified_partnerships
        description: >
          This value is the number of verified Partnerships on a Salesforce Account.
      - name: number_of_all_partnerships
        description: >
          This value is the number of total Partnersihps on a Salesforce Account, inclusive of informal partnerships.
      - name: orchestrator
        description: >
          The current orchestration tool an Account is using.
          This value is dervied from a picklist field in Salesforce, and is filled out by the SA/SD during the technical win flow.
          If the value in this field is "Other", then the value is stored in `orchestrator_other`.
      - name: orchestrator_other
        description: >
          A free-form text field to specify any orchestration tools an Account is using outside of those in `orchestrator`.
      - name: preferred_cloud_platform
        description: >
          The Account's preferred cloud platform.
          This value is derived from a picklist field in Salesforce.
          Examples include: AWS, Azure, and GCP.
      - name: customer_health
        description: >
          A combination of feature usage, dbt's value, engagement, and relationship metrics to combine to create an overall customer health score.
          More information can be found here: [Link to Customer Health Scoring Methodology](https://www.notion.so/dbtlabs/Customer-Health-0a8363c95ab6450baa638363ef3f3183)
      - name: abm_stage
        description: >
          The account based marketing stage derived from `int_account_based_marketing_stages`. This indicates the level of engagement that a Salesforce account has had with us.
          It is used to drive Account Based Marketing efforts. Example values include Target, Awareness, Consideration, Decision, Purchase.
      - name: abm_tier
        description: >
          The account based marketing stage tier. Options are Tier 1, Tier 2, and Tier 3.
          These tiers are used for Account Based Marketing efforts. Primarily to send through Hightouch to our advertising platforms.
      - name: partner_customers
        description: >
          The list of Crossbeam Partners where our Salesforce Accounts is a current customer
      - name: partner_prospects
        description: >
          The list of Crossbeam Partners where our Salesforce Accounts is a current prospect
      - name: partner_opportunities
        description: >
          The list of Crossbeam Partners where our Salesforce Accounts has an open opportunity with our partner
      - name: is_fortune500
        description: Indicates whether or not the Account is a member of the Fortune 500
      - name: is_global500
        description: Indicates whether or not the Account is a member of the Global 500
      - name: is_americas_largest_private
        description: Indicates whether or not the Account is a member of the America's Largest Private Companies list
      - name: account_hierarchy_type
        description: The hierarchy type for this Account, e.g. Subsidiary, Parent
      - name: customer_tier
        description: The Customer Tier designated to this Account based on our tiering logic
      - name: overridden_customer_tier
        description: The effective Customer Tier for this Account, if it has been overridden or promoted
      - name: hierarchy_current_arr
        description: The current ARR for the Account's full hierarchy (includes parent, sibling and child Accounts)
      - name: sd_hierarchy_current_arr
        description: The current ARR for the portion of the Account hierarchy owned by this Account's Owner/SD.
      - name: sales_team
        description: The Sales Team that the Salesforce Account is owned by.

  - name: dim_salesforce_contacts
    description: >
      The dim_salesforce_contacts dataset includes one row per Salesforce Contact.
      A contact in Salesforce represents the individual people identified within our organization.
      This table can be used to look at the demographic information related to a Contact, or any aggregated Salesforce activity metrics.
      Contacts are created either automatically, through a form fill or signup process, or added mnaually by the Sales & Operations teams.
    columns:
      - name: contact_id
        description: "The Salesforce Contact id"

      - name: account_id
        description: '{{ doc("sfdc_account_id") }}'

      - name: archive_reason
        description: "The reason a Salesforce Contact had their Contact Status moved to Archive"

      - name: owner_id
        description: >
          The id of the user who owns the contact.
          This is often the Sales Director (SD) or Sales Development Representative (SDR).

      - name: created_by_id
        description: "The id of the user who created the contact"

      - name: reports_to_id
        description: "The ID of the Salesforce user that the contact reports to."

      - name: current_sequence_owner_id
        description: >
          The ID of the owner of the sequence the contact is currently in.
          This is typically an SD or SDR on the Sales team.

      - name: impartner_primary_contact_id
        description: "A lookup field to retrieve the Impartner Contact id"

      - name: qualified_touchpoint_id
        description: >
          The ID of the most recent qualified touchpoint for a contact.
          This can be joined to the `stg_salesforce__touchpoints` model to get touchpoint details.

      - name: zendesk_user_id
        description: "The ID of the user in Zendesk."

      - name: initial_sequence_id
        description: "The ID of the first sequence a contact was in."

      - name: current_sequence_id
        description: "The ID of the current sequence a contact is in."

      - name: account_id_from_domain
        description: >
          The Account ID associated with the contact's email address.
          This isn't always the same as the Account ID, and therefore the Account ID field is more reliable.

      - name: last_modified_by_id
        description: "The id of the user who last modified the contact."

      - name: domain_id
        description: "The ID of the domain associated with the contact's email."

      - name: description
        description: "The description of the contact."

      - name: email
        description: "The email address for a contact."

      - name: name
        description: "The full name of a contact."

      - name: first_name
        description: "The first name of a contact."

      - name: last_name
        description: "The last name of a contact."

      - name: title
        description: "The job title for a contact."

      - name: salutation
        description: "The salutation of a contact."

      - name: phone
        description: "The phone number of a contact."

      - name: photo_url
        description: "A URL that links to a photo of a contact."

      - name: linkedin
        description: "A URL that links to a contact's LinkedIn page."

      - name: account_type
        description: "The Account Type for the account the contact is associated with."

      - name: contact_status
        description: >
          The current working status for a contact.
          This is updated by the SDR team as a contact moves through the qualification and promotion process.
          Example values include: new, qualified, assigned, engaging, working, and promoted, among others.

      - name: created_reason
        description: "Indicates if a contact is created as a result of a lead conversion or dbt Cloud sign up."

      - name: lead_source
        description: "The lead source associated with creating the contact."

      - name: how_did_you_hear_about_us
        description: "A free form text field collected on the Contact Sales form."

      - name: city
        description: "The city where the contact lives."

      - name: country
        description: "The country where the contact lives."

      - name: country_code
        description: >
          The 2 digit Country Code where the contact lives.
          Examples include: US, GB

      - name: postal_code
        description: "The postal code where the contact lives."

      - name: state
        description: "The state where the contact lives."

      - name: state_code
        description: >
          The state code where the contact lives.
          Examples include: NY, CA

      - name: street
        description: "The street address where the contact lives"

      - name: region_category
        description: >
          The region where the contact lives.
          This is populated by matching the `country_code` to a region using the `stg_seed__country_to_region` mapping file.

      - name: role
        description: >
          An enrichment field provided by Clearbit that aims to standardize a contact's role within a company.
          This is based off of the contact's job title.

      - name: sub_role
        description: >
          An enrichment field provided by Clearbit that aims to standardize a contact's role within a company to a specific function.
          This is based off of the contact's job title.

      - name: seniority
        description: >
          An enrichment field provided by Clearbit that aims to standardize a contact's seniority within a company.
          This is based off of the contact's job title.

      - name: most_recent_cloud_billing_plan
        description: "Most recent billing plan on the most recently created dbt Cloud User"

      - name: most_recent_touchpoint_cloud_billing_plan
        description: "Most recent billing plan on the dbt Cloud Account on the most recently created Sign Up Touchpoint"

      - name: mmerp__lastdirection
        description: "The last direction (sent or received) of an email as identified through the Match My Email activity report."

      - name: mmerp__lastsubject
        description: "The subject line of the last email a contact was included in, as identified through the Match My Email activity report."

      - name: mmerp__firstsubjectrecv
        description: "The subject line of the first email a contact was included in, as identified through the Match My Email activity report."

      - name: mmerp__firstfromsent
        description: "The from name and email of the first email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__responsegap
        description: "The number of hours that have elapsed since an email was received by a user. This is calculated using `mmerp__lastdatetimesent` - `mmerp__lastdatetimerecv`"

      - name: mmerp__lastfrom
        description: "The from name and email on the last email associated with a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastsubjectrecv
        description: "The subject live of the last email received by a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastfromrecv
        description: "The from name and email on the last email received by a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstdirection
        description: "The first direction (sent or received) of an email as identified through the Match My Email activity report."

      - name: mmerp__firstsubject
        description: "The subject line of the first email associated with a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstfrom
        description: "The from name and email on the first email associated with a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastfromsent
        description: "The from name and email on the last email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastsubjectsent
        description: "The subject line of the last email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstsubjectsent
        description: "The subject line of the first email sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstfromrecv
        description: "The from name and email on the first email received by a contact, as identified through the Match My Email activity report."

      - name: current_sequence_name
        description: >
          The name of the current sequence a contact is in.
          Sequences are utilized by the SDR team to reach out to contacts that have expressed intersted in our product.

      - name: current_sequence_step_number
        description: "The step number the contact is in within the current sequence."

      - name: current_sequence_step_type
        description: >
          The step type the contact is in within the current sequence.
          Examples include manual_email, auto_email, linkedin_send_message, linkedin_send_connection_request, and others.

      - name: finished_sequences
        description: "A text field that includes a list of sequences that a contact has been in that are considered finished."

      - name: initial_sequence_name
        description: "The name of the first sequence a contact was included in."

      - name: sequence_to_add_to
        description: "The name of the sequence a contact is expected to be added to."

      - name: current_sequence_owner
        description: "The name of the employee who owns the current sequence a contact is in. This is most frequently an SDR or SD."

      - name: most_recent_touchpoint_source
        description: "The most recent `touchpoint_source` for a given contact."

      - name: most_recent_touchpoint_status
        description: "The most recent `touchpoint_source_status` for a given contact."

      - name: is_deleted
        description: "A boolean field (true/false) that indicates if the touchpoint is deleted."

      - name: is_email_bounced
        description: "A boolean field indicating if an email bounced when being sent to a contact."

      - name: is_consumer_domain
        description: "A boolean field indicating whether or not a contact's email includes a consumer domain"

      - name: is_actively_being_sequenced
        description: "A boolean field indicating if a contact is currently in a sequence."

      - name: matches_primary_account_domain
        description: "A boolean field indicating if the contact's email domain matches that of their associated account."

      - name: has_opted_out_of_email
        description: "A boolean field indicating if a contact has opted out of receiving emails."

      - name: account_matches_domain_account
        description: "A boolean field indicating if a contact's domain matches that of their associated account."

      - name: is_synced_to_zendesk
        description: "A boolean field indicating if a contact is synced to Zendesk."

      - name: total_emails_outreach
        description: "The total number of emails a contact is included in via Outreach."

      - name: mmerp__total_emails
        description: "The total number of emails as identified through the Match My Email activity report."

      - name: total_emails
        description: >
          The total number of emails a contact is included in.
          This includes both MME and Outreach.

      - name: total_recv_emails_outreach
        description: "The total number of emails received from a contact through Outreach."

      - name: mmerp__totalrecv
        description: "The total number of emails received from a contact, as identified through the Match My Email activity report."

      - name: total_recv_emails
        description: >
          The total number of emails received by a contact.
          This includes both MME and Outreach.

      - name: total_sent_emails_outreach
        description: "The total number of emails sent to a contact through Outreach."

      - name: mmerp__totalsent
        description: "The total number of emails sent to a contact, as identified through the Match My Email activity report."

      - name: total_sent_emails
        description: >
          The total number of emails sent to a contact.
          This includes both MME and Outreach.

      - name: number_of_active_sequences
        description: "The total number of sequences a contact is currently in."

      - name: number_of_active_tasks
        description: "The total number of tasks associated with a contact."

      - name: count_of_touchpoints_all_time
        description: "The total number of touchpoints associated with a contact."

      - name: count_of_90d_touchpoints
        description: "The total number of touchpoints associated with a contact that occured in the last 90 days."

      - name: contact_created_at
        description: "A timestamp indicating when a contact was created."

      - name: last_activity_date
        description: "A timestamp indicating when a contact was last active."

      - name: last_modified_date
        description: "A timestamp indicating when a contact was last modified."

      - name: last_referenced_date
        description: "A timestamp indicating when a contact was last referenced."

      - name: last_viewed_date
        description: "A timestamp indicating when a contact was last viewed."

      - name: promoted_at
        description: "A timestamp indicating when a contact was last promoted."

      - name: qualified_at
        description: >
          A timestamp indicated when the touchpoint resulted in a qualified contact.
          This field is a combination of the `opened_at` field and the `is_qualified_touchpoint` field.

      - name: most_recent_cloud_sign_up_at
        description: "Most recent created_at on the most recently created dbt Cloud User"

      - name: most_recent_touchpoint_cloud_sign_up_at
        description: "Most recent created_at on the dbt Cloud Account on the most recently created Sign Up Touchpoint"

      - name: current_sequence_task_due_at
        description: "A timestamp indicating when the current sequence is due."

      - name: added_to_current_sequence_at
        description: "A timestamp indicating when a contact was added to the current sequence."

      - name: initial_sequence_at
        description: "A timestamp indicating when a contact was added to their first sequence."

      - name: first_email_at
        description: "A timestamp of the first email a contact was included in."

      - name: last_email_at
        description: "A timestamp of the last email a contact was included in."

      - name: first_recv_email_at
        description: "A timestamp of the first email received from a contact."

      - name: first_recv_email_outreach_at
        description: "A timestamp of the first email received from a contact through Outreach."

      - name: first_sent_email_outreach_at
        description: "A timestamp of the first email sent to a contact through Outreach."

      - name: last_recv_email_outreach_at
        description: "A timestamp of the last email received from a contact through Outreach."

      - name: first_email_outreach_at
        description: "A timestamp of the first email sent to a contact through Outreach"

      - name: last_sent_email_outreach_at
        description: "A timestamp of the last email sent to a contact through Outreach."

      - name: last_email_outreach_at
        description: "A timestamp of the last email a contact was included in through Outreach."

      - name: last_sent_email
        description: "A timestamp of the last email sent to a contact."

      - name: last_recv_email
        description: "A timestamp of the last email received from a contact."

      - name: first_sent_email
        description: "A timestamp of the first email sent to a contact."

      - name: mmerp__firstdatetimesent_at
        description: "A timestamp indicating when an email was first sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstdatetimerecv_at
        description: "A timestamp indicating when an email was first received by a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastdatetimesent_at
        description: "A timestamp indicating when an email was last sent to a contact, as identified through the Match My Email activity report."

      - name: mmerp__lastdatetimerecv_at
        description: "A timestamp indicating when an email was last received from a contact, as identified through the Match My Email activity report."

      - name: mmerp__firstdatetime_at
        description: "A timestamp indicating when the first email a contact is associated with occured, as identified through the Match My Email activity report."

      - name: mmerp__lastdatetime_at
        description: "A timestamp indicating when the last email a contact is associated with occurred, as identified through the Match My Email activity report."

      - name: system_modstamp
        description: "A timestamp indicating when the record was last modified by a user or an automated process."

      - name: persona
        description: '{{ doc("persona") }}'

      - name: contact_in_account_index
        description: "The Nth contact in a Salesforce Account."

      - name: qualified_touchpoint_source
        description: "The touchpoint source from the most recent qualified touchpoint for the contact."

      - name: qualified_touchpoint_source_type
        description: "The touchpoint source type from the most recent qualified touchpoint for the contact."

      - name: qualified_touchpoint_source_detail
        description: "The touchpoint source detail from the most recent qualified touchpoint for the contact."

      - name: is_qualified
        description: "A boolean indicating if a contact is qualified or not."

  - name: dim_salesforce_territory_assignments
    description: The [Salesforce Sales Directory Territory assignments](https://fishtown.lightning.force.com/lightning/r/Report/00O4v000008E5GIEA0/view).
    columns:
      - name: territory_assignments_id
        tests:
          - not_null
          - unique

  - name: fct_opportunities_line_items
    description: >
      This model contains 1 row per line item in an opportunity.
      A line item is a specific product included in a deal with an Enterprise customer.
      Examples of line items include, but are not limited to: Develop Licenses, Rapid Onboarding Hours, or Single Tenant Deployments.
      This information can be used to understand how much revenue each individual product is contributing to our business.
      This data can be joined to Salesforce Opportunities using the `opportunity_id` field to further filter or segment this data to relevant deals.
    columns:
      - name: opportunity_line_item_id
        description: The unique identifier for the opportunity line item.
        tests:
          - unique
          - not_null

      - name: created_by_id
        description: The ID of the user who created the line item.

      - name: opportunity_id
        description: The ID of the opportunity the line item is associated with.

      - name: pricebook_entry_id
        description: The pricebook entry identifier.

      - name: product_id
        description: >
          The product identifier.
          This can be joined to `stg_salesforce__products` to retrieve additional product information.

      - name: last_modified_by_id
        description: The ID of the user who last modified the line item.

      - name: sbqq_quote_line_id
        description: The ID of the Salesforce CPQ quote line item.

      - name: line_item_name
        description: >
          The name of the line item.
          This is known as "Opportunity Product" in the user interface.
          This follows the pattern of "`Account Name` - `Opportunity Type` `Product Name`".

      - name: product_name
        description: >
          The name of the product associated with the line item.
          Examples include: Devlop License, Service Hour, etc.

      - name: product_code
        description: '{{ doc("sfdc_product_code") }}'

      - name: line_description
        description: >
          A description of the line item as entered in Salesforce.
          This is used to provide any additional information that should be known about a line item.

      - name: unit
        description: >
          This field specifies the quantity unit of measure for the line item.
          Examples include: Each, License, Hours, Deployment, and Course.
        tests:
          # Validates work in fct_services_delivery
          - accepted_values:
              values: ["Hour"]
              config:
                where: is_professional_services or is_training

      - name: quantity
        description: >
          The number of units contained within a line item.
          For example, 50 develop licenses would contain a quantity of 50.

      - name: sort_order
        description: >
          Number indicating the sort order selected by the user.
          This is used to match the sort order in our models to the Salesforce UI.

      - name: subscription_type
        description: >
          The type of subscription the line item adheres to.
          Examples include: Renewable, One-Time, and Evergreen.

      - name: is_on_prem
        description: >
          A boolean field indicating if the line item `product_code` contains `deployment_vpc`.

      - name: is_service_hour
        description: >
          A boolean field indicating if the line item `product_code` contains `service_hour`.

      - name: was_created_after_close_date
        description: A boolean field indicating if the line item was created after the deal closed.

      - name: discount_pct
        description: The discount for the line item as a percentage.

      - name: list_price
        description: '{{ doc("list_price") }}'

      - name: total_price
        description: '{{ doc("opportunity_total_price") }}'

      - name: unit_price
        description: '{{ doc("opportunity_unit_price") }}'

      - name: mrr
        description: The monthly revenue amount for the line item.

      - name: arr
        description: The annual revenue amount for the line item.

      - name: rate
        description: >
          The actual price of the unit contained in the line item.
          For example, if the line item contains 50 develop licenses, this would equate to the cost per license.

      - name: subtotal_amount
        description: >
          The total price of the line item before discounts.
          This is calculated as `unit_price` * `quantity`.

      - name: charge_type
        description: >
          The cadence in which the line item will be charged.
          Examples include: Recurring and One-Time.

      - name: scheduling_notes
        description: A open-text field that provides context to any scheduling of rapid onboarding line items.

      - name: quantity_used
        description: >
          This field is specific to rapid onboarding line items.
          It explains how many onboarding sessions have been used.
          This field is manually entered by the ProServe team.

      - name: quantity_scheduled
        description: >
          This field is specific to rapid onboarding line items.
          It explains how many onboarding sessions have been scheduled.
          Refer to the `scheduling_notes` field to see more details.
          This field is manually entered by the ProServe team.

      - name: quantity_deferred
        description: >
          This field is specific to rapid onboarding line items.
          It explains how many rapid onboarding have been deferred (won't be used).
          This field is manually entered by the ProServe team.

      - name: usage_status
        description: >
          Will be `Scheduled` if some units have been scheduled, `Delivered` if all units have been used, or otherwise `Null`.

      - name: duration
        description: >
          The number of months the line item is purchased for.
          This value can be a decimal to appropriately pro-rate the deal.
          For a 12-month deal, this value will be 12.
          For expand deals, this might be the number of months left in the existing deal with proration, for example 2.3

      - name: time_unit
        description: >
          The unit of time in which the product is sold for.
          Examples include Month, Year, and None.

      - name: desired_start_date
        description: >
          The desired start date for a rapid onboarding product.

      - name: service_date
        description: >
          A timestamp indicating when service for the line item begins.

      - name: starts_on
        description: >
          A timestamp indicating when the line item is available to the customer.

      - name: ends_on
        description: >
          A timestamp indicating when the line item is no longer available to the customer.

      - name: last_modified_at
        description: A timestamp indicating when the line item was last modified.

      - name: created_at
        description: A timestamp indicating when the line item was created.

      - name: system_modstamp
        description: A timestamp indicating when the line item was last modified by a user or an automated process.

  - name: fct_opportunities
    columns:
      - name: opportunity_id
        tests:
          - unique
          - not_null
      - name: opener_id
        description: >
          The User ID of the individual who opened the opportunity.
          This maps to the User object in Salesforce and the Owners models in our dbt Project.
      - name: total_cloud_accounts
        description: "The total dbt Cloud accounts associated with this opportunity/Salesforce Account, including deleted Cloud accounts."
      - name: total_active_cloud_accounts
        description: "The total _non-deleted_ dbt Cloud accounts associated with this opportunity/Salesforce Account."
      - name: opportunity_index
        description: >
          The opportunity number for a given account. For example, 1st opportunity created for an account, 2nd, etc. This is mainly used into the `fct_campaign_members` model.
      - name: furthest_non_closed_stage_achieved
        description: >
          The furthest stage that an opportunity progressed to based off of the `stage_sort_order`.
          This is excluding closed stages (i.e. Closed Lost, Closed Won).
          This can be used to understand the furthest stage an opportunity made it before being marked `is_closed`.
      - name: furthest_pipeline_stage_achieved
        description: >
          The furthest pipeline stage that an opportunity progressed to.
          This includes the current state of the opportunity.
          For example, if an opportunity that was once in pre-pipeline and is now in pipeline, then it will be marked as "Pipeline"
          This includes closed opportunities, allowing for historical analysis.
          If you want to look at active opportunities, please use filter `is_closed = false`.
      - name: alternatives_prospect_was_evaluating
        description: Any alternatives that a prospect was evaluating during their opportunity. This is manually entered by the Sales team.
      - name: current_data_transformation_tool
        description: The current data transformation tool that a prospect is using. This is manually entered by the Sales team.
      - name: is_from_nurtured_opportunity
        description: A boolean field (true/false) that indicates if an opportunity was re-opened from an existing nurture opportunity.
      - name: business_case_overview_video_url
        description: >
          A link to a Loom video explaining the use case for dbt for an account.
          This can be used to get a quick overview of why an account has a need for dbt, as well as some qualitative information from the sales team regarding the use case.
      - name: opener_name
        description: The name of the individual who opened the opportunity.
      - name: opener_role
        description: The role of the individual who opened the opportunity.
      - name: partner_manager_name
        description: >
            The full name of the partner manager assigned to the opportunity. 
            Consulting partners are typically managed by a single partner manager, 
            but some consulting partners span regions. This field enables dbt to override 
            the default partner manager and split up work across multiple partner managers.
      - name: sa_next_steps
        description: The opportunity's next steps from the SA side.
      - name: is_p1_migration_opportunity
        description: Flag indicating whether this opportunity is linked to the Dec. 2022 Teams pricing change.
      - name: source_type
        description: >
          A temporary field that will allow the pipeline team to group the lead source associated with the opportunity into three specific groups: Demand Generation, Direct Demand, and Partner Referred Inbound.
          Once we implement our formal attribution model, this field will be replaced with the `channel_grouping` field from `fct_notion_channel_mapping`.
      - name: opportunity_use_case
        description: >
          A description of why the customer bought dbt.
          This is populated during the Closed Won flow in Salesforce.
      - name: has_orders
        description: A boolean indicating whether a given opportunity has associated orders.
      - name: count_of_orders_created
        description: >
          The count of Salesforce orders set up as associated with the given opportunity.
          This was added as it was observed some opportunities tie to multiple orders.
      - name: is_out_of_compliance
        description: >
          A flag that illustrated which pre-pipeline opportunities are out of compliance.
          Out of comliance means that these opportunities should've ben moved from Pre-Pipeline to Pipeline or Closed Lost.

  - name: fct_opportunity_attribution
    description: '{{ doc("fct_opportunity_attribution") }}'
    columns:
      - name: opportunity_touchpoint_id
        description: >
          A surrogate key created off of the `opportunity_id` and `touchpoint_id`.
        tests:
          - unique
          - not_null

      - name: opportunity_id
        description: The opportunity ID from Salesforce.

      - name: touchpoint_id
        description: The touchpoint ID from Salesforce.

      - name: external_touchpoint_id
        description: >
          The external touchpoint ID from Salesforce.
          For data synced from outside sources, this will be the `event_id`.

      - name: account_id
        description: The Salesforce Account ID

      - name: contact_id
        description: The Salesforce Contact ID

      - name: opportunity_touchpoint_index
        description: >
          The Nth touchpoint for a given opportunity.
          This index starts at 1.
          For example, the first touchpoint for a given opportunity will have a value of `1`.

      - name: touchpoint_name
        description: >
          The touchpoint name derived from Salesforce. This follows the format of: L-#########

      - name: touchpoint_source_detail
        description: >
          Additional detail that provides context to the touchpoint.
          An example includes the name of the Webinar that resulted in a Webinar touchpoint.

      - name: touchpoint_source_type
        description: >
          Synonymous with team: this is the team that is responsible for the touchpoint.

      - name: touchpoint_source
        description: >
          The source of the touchpoint.
          Examples include Contact Sales, Sign Up, SDR Outbound, etc.

      - name: touchpoint_status
        description: >
          The current status of the touchpoint.
          Examples include New, Promoted, Working - Reached Out, and Archived.

      - name: touchpoint_group
        description: >
          A high-level grouping of the `touchpoint_source` field.
          Examples include: Website Sessions, Website Conversions, and Salesforce Tasks.

      - name: source_type
        description: >
          A high-level grouping, or bucketing, of the touchpoint source.
          Source types fall into four specific groups: Demand Generation, Direct Demand, Partner Referred Inbound, and Product Upsell.
          This field is reference from the `source_type` field in the `fct_notion_channel_mapping` model.

      - name: team
        description: >
          The team that is credited for the touchpoint.

      - name: channel_grouping
        description: >
          The highest level grouping of the event, as determined by the Channel Mapping dataset.
          Examples include: Inbound Free, Inbound Paid, and Direct.

      - name: channel
        description: >
          A grouped version of the `medium` field, as determined by the Channel Mapping dataset.
          Examples include: Paid Search, Organic Social, and Email.

      - name: sub_channel
        description: >
          A grouped version of the `source` field, as determined by the Channel Mapping dataset.
          Examples include: Google, LinkedIn, and HubSpot.

      - name: data_source
        description: >
          The data source in which the touchpoint originated.
          Examples include: Snowplow Sessions, Snowplow Conversions, and Salesforce Touchpoints.

      - name: utm_medium
        description: >
          The `utm_medium` value from the touchpoint.

      - name: utm_source
        description: >
          The `utm_source` value from the event.
          For partner connect signups, this will be either `snowflake` or `databricks`.

      - name: utm_campaign
        description: >
          The `utm_campaign` value from the touchpoint.

      - name: is_attributable
        description: >
          A boolean that indicates whether a touchpoint will be included in attribution modeling or not.
          Currently, direct and internal web sessions are the only exclusions.

      - name: is_within_attribution_window
        description: >
          A boolean that indicates whether the touchpoint occured within the attribution window to be considered for measurement.
          Currently, this is set as 90 days before opportunity creation.

      - name: is_first_touch
        description: >
          A boolean that indicates if a touchpoint is the first touchpoint in the attribution window.

      - name: is_lead_creation_event
        description: >
          A boolean that indicates if a touchpoint is the first lead creation event in the attribution window.
          Attribution events include website conversions & touchpoints registered in Salesforce directly.

      - name: is_opportunity_creation_event
        description: >
          A boolean that indicates if a touchpoint is associated with the opportunity being created.
          This should mirror our existing opportunity source touchpoint.

      - name: is_deleted
        description: >
          A boolean field (true/false) that indicates if the touchpoint is deleted.

      - name: opened_at
        description: >
          A timestamp indicated when the touchpoint was opened.
          This is the standard field that should be used when analyzing touchpoints for a given timeframe.
          This field is different than `created_at` in that it can be adjusted after the fact, resulting in more accurate values.

      - name: opportunity_created_at
        description: >
          A timestamp indicating when the opportunity was created.

      - name: opportunity_discovered_at
        description: >
          A timestamp indicating when the opportunity first reached the `discover` stage.

      - name: days_from_touchpoint_to_opportunity_creation
        description: >
          The number of days between a touchpoint and its associated opportunity creation date.

      - name: days_from_touchpoint_to_opportunity_discovered
        description: >
          The number of days between a touchpoint and its associated opportunity discovered at date.

      - name: delta_arr
        description: >
          The delta ARR for the opportunity.

      - name: count_of_opportunity_touchpoints
        description: >
          The count of touchpoints within the attribution window.
          This is a vital number that enables us to calculate attributed credit.

      - name: count_of_key_attributable_touchpoints
        description: >
          The count of first touch, lead creation, or opportunity creation touchpoints within the attribution window.
          This is a vital number that enables us to calculate attributed credit.

      - name: touchpoint_credit_w_shape
        description: >
          The credit for a given touchpoint using a W-Shaped attribution model.

      - name: touchpoint_credit_w_shape_pct
        description: >
          A percent-formatted version of the `touchpoint_credit_w_shape` field.

      - name: touchpoint_credit_linear
        description: >
          The credit for a given touchpoint using a linear attribution model.

      - name: touchpoint_credit_linear_pct
        description: >
          A percent-formatted version of the `touchpoint_credit_linear` field.

      - name: touchpoint_credit_last_touch
        description: >
          The credit for a given touchpoint using a last-touch attribution model.

      - name: touchpoint_credit_last_touch_pct
        description: >
          A percent-formatted version of the `touchpoint_credit_last_touch` field.

      - name: touchpoint_credit_first_touch
        description: >
          The credit for a given touchpoint using a first-touch attribution model.

      - name: touchpoint_credit_first_touch_pct
        description: >
          A percent-formatted version of the `touchpoint_credit_first_touch` field.

      - name: attributed_delta_arr_w_shape
        description: >
          The attributed dollar value for a touchpoint using a W-Shaped attribution model.

      - name: attributed_delta_arr_linear
        description: >
          The attributed dollar value for a touchpoint using a linear attribution model.

      - name: attributed_delta_arr_last_touch
        description: >
          The attributed dollar value for a touchpoint using a last-touch attribution model.

      - name: attributed_delta_arr_first_touch
        description: >
          The attributed dollar value for a touchpoint using a first-touch attribution model.

  - name: fct_opportunity_history
    columns:
      - name: id
        tests:
          - unique
          - not_null

  - name: fct_salesforce_credit_note_items
    description: >
      This model includes one row per credit note item from Salesforce. 
    columns:
      - name: sfdc_credit_note_item_id
        description: '{{ doc("sfdc_credit_note_item_id") }}'
        tests:
          - unique
          - not_null
      - name: sfdc_credit_note_id
        description: '{{ doc("sfdc_credit_note_id") }}'
      - name: credit_note_name
        description: '{{ doc("credit_note_name") }}'
      - name: sfdc_account_id
        description: '{{ doc("sfdc_account_id") }}'
      - name: account_name
        description: '{{ doc("salesforce_account_name") }}'
      - name: product_name
        description: '{{ doc("product_name") }}'
      - name: product_type
        description: '{{ doc("product_type") }}'
      - name: product_family
        description: '{{ doc("product_family") }}'
      - name: credit_note_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: credit_note_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: invoice_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: invoice_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: payment_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: payment_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: refund_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: refund_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: rev_rec_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: rev_rec_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

  - name: fct_salesforce_credit_notes
    description: >
      This model includes one row per credit note from Salesforce. 
    columns:
      - name: sfdc_credit_note_id
        description: '{{ doc("sfdc_credit_note_id") }}'
        tests:
          - unique
          - not_null
      - name: credit_note_name
        description: '{{ doc("credit_note_name") }}'
      - name: credit_note_date
        description: '{{ doc("credit_note_date") }}'
      - name: sfdc_account_id
        description: '{{ doc("sfdc_account_id") }}'
      - name: account_name
        description: '{{ doc("salesforce_account_name") }}'
      - name: subtotal_amount
        description: '{{ doc("credit_note_subtotal_amount") }}'
      - name: tax_amount
        description: '{{ doc("credit_note_tax_amount") }}'
      - name: notes
        description: '{{ doc("credit_note_notes") }}'

  - name: fct_salesforce_order_items
    description: "One row per line item in a Salesforce order"
    columns:
      - name: sfdc_order_item_id
        description: '{{ doc("sfdc_order_item_id") }}'
        tests:
          - unique
          - not_null

      - name: order_item_number
        description: '{{ doc("order_item_number") }}'

      - name: sfdc_order_id
        description: '{{ doc("sfdc_order_id_foreign") }}'

      - name: order_number
        description: '{{ doc("order_number") }}'

      - name: order_status
        description: '{{ doc("order_status") }}'

      - name: opportunity_name
        description: '{{ doc("opportunity_name") }}'

      - name: service_start_date
        description: '{{ doc("service_start_date") }}'

      - name: service_end_date
        description: '{{ doc("service_end_date") }}'

      - name: product_name
        description: "The name of the dbt Labs product being itemized."

      - name: quantity
        description: '{{ doc("order_item_quantity") }}'

      - name: list_price
        description: '{{ doc("list_price") }}'

      - name: list_price_reflecting_package
        description: >
          {{ doc("list_price") }} This field in particular is determined based on the package purchased in
          the overall order.

      - name: unit_price
        description: '{{ doc("order_item_unit_price") }}'

      - name: total_price
        description: '{{ doc("order_item_total_price") }}'

      - name: product_ssp_midpoint_percentage
        description: '{{ doc("ssp_midpoint_percentage") }}'

      - name: product_ssp_midpoint
        description: '{{ doc("ssp_midpoint") }}'

      - name: product_low_discount_threshold
        description: '{{ doc("product_low_discount_threshold") }}'

      - name: product_high_discount_threshold
        description: '{{ doc("product_high_discount_threshold") }}'

      - name: has_schedules
        description: A boolean indicating whether the order item has an associated revenue schedule.

      - name: count_of_schedules
        description: The count of schedules created against the order item.

      - name: sfdc_opportunity_id
        description: The ID of the associated Salesforce opportunity.

      - name: sfdc_account_id
        description: '{{ doc("sfdc_account_id") }}'

      - name: credit_note_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: credit_note_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: invoice_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: invoice_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: payment_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: payment_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: refund_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: refund_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: rev_rec_credit
        description: '{{ doc("accounting_credit_debit_pair") }}'

      - name: rev_rec_debit
        description: '{{ doc("accounting_credit_debit_pair") }}'
        
      - name: billing_city
        description: '{{ doc("billing_city") }}'

      - name: billing_state
        description: '{{ doc("billing_state") }}'

      - name: billing_state_code
        description: '{{ doc("billing_state_code") }}'

      - name: billing_postal_code
        description: '{{ doc("billing_postal_code") }}'

      - name: billing_country
        description: '{{ doc("billing_country") }}'

      - name: billing_country_code
        description: '{{ doc("billing_country_code") }}'

      - name: billing_region
        description: '{{ doc("billing_region") }}'

      - name: ship_to_name
        description: '{{ doc("ship_to_name") }}'

      - name: shipping_street
        description: '{{ doc("shipping_street") }}'

      - name: shipping_city
        description: '{{ doc("shipping_city") }}'

      - name: shipping_state
        description: '{{ doc("shipping_state") }}'

      - name: shipping_state_code
        description: '{{ doc("shipping_state_code") }}'

      - name: shipping_postal_code
        description: '{{ doc("shipping_postal_code") }}'

      - name: shipping_country
        description: '{{ doc("shipping_country") }}'

      - name: shipping_country_code
        description: '{{ doc("shipping_country_code") }}'

      - name: shipping_region
        description: '{{ doc("shipping_region") }}'

  - name: fct_salesforce_activities
    description: >
      This model includes one row per event and/or task from Salesforce.
      The information in this model is intended to replicate the Activites tile in Salesforce.
    columns:
      - name: activity_ref_id
        description: >
          The unique identifier to the table.
          This value can be populated by either the `event_id` from salesforce events, or `task_id` from salesforce tasks.
        tests:
          - unique
          - not_null

  - name: fct_salesforce_orders
    description: One row per Salesforce order.
    columns:
      - name: sfdc_order_id
        tests:
          - unique
          - not_null

      - name: sfdc_account_id
        description: '{{ doc("sfdc_account_id") }}'

      - name: sfdc_opportunity_id
        description: The ID of the associated Salesforce opportunity.

      - name: owner_id
        description: The ID of the user who owns the order. This is often the Sales Director (SD) or Sales Development Representative (SDR).

      - name: contract_id
        description: The ID of the associated Salesforce contract.

      - name: pricebook2_id
        description: The ID of the associated Salesforce pricebook.

      - name: created_by_id
        description: The ID of the user in Salesforce who created the element.

      - name: order_number
        description: >
          The human-trackable identifier indicating the specific order. Whereas sfdc_order_id is an architectural identifier,
          this is a business identifier.

      - name: po_number
        description: Short for Purchase Order number, this an order identifier from the customer's systems. Required to associate an order from one system to another.

      - name: po_required
        description: An indicator of whether a customer PO number is required.

      - name: order_type
        description: The business type of the order (e.g New, Renewal, Amendment).

      - name: order_status
        description: '{{ doc("order_status") }}'

      - name: order_status_code
        description: An additional code indicating order status. Note that this will be as of the last data refresh.

      - name: order_description
        description: A open-ended field including any information the owner chose to include about the order.

      - name: is_reduction_order
        description: An indicator as to whether an order represents an agreement to reduce services. This is a Salesforce structure.

      - name: total_amount
        description: '{{ doc("order_total_price") }}'

      - name: tax_exempt
        description: An indicator as to whether the order is exempt from sales tax.

      - name: bill_to_contact_id
        description: '{{ doc("bill_to_contact_id") }}'

      - name: bill_to_name
        description: '{{ doc("bill_to_name") }}'

      - name: billing_street
        description: '{{ doc("billing_street") }}'

      - name: billing_city
        description: '{{ doc("billing_city") }}'

      - name: billing_state
        description: '{{ doc("billing_state") }}'

      - name: billing_state_code
        description: '{{ doc("billing_state_code") }}'

      - name: billing_postal_code
        description: '{{ doc("billing_postal_code") }}'

      - name: billing_country
        description: '{{ doc("billing_country") }}'

      - name: billing_country_code
        description: '{{ doc("billing_country_code") }}'

      - name: ship_to_name
        description: '{{ doc("ship_to_name") }}'

      - name: shipping_street
        description: '{{ doc("shipping_street") }}'

      - name: shipping_city
        description: '{{ doc("shipping_city") }}'

      - name: shipping_state
        description: '{{ doc("shipping_state") }}'

      - name: shipping_state_code
        description: '{{ doc("shipping_state_code") }}'

      - name: shipping_postal_code
        description: '{{ doc("shipping_postal_code") }}'

      - name: shipping_country
        description: '{{ doc("shipping_country") }}'

      - name: shipping_country_code
        description: '{{ doc("shipping_country_code") }}'

      - name: created_at
        description: The timestamp on which the order was created.

      - name: effective_date
        description: The timestamp at which the order took effect.

      - name: activated_by_id
        description: The Salesforce user ID for the associate who activated the order.

      - name: activated_date
        description: The timestamp at which the order was activated.

      - name: last_modified_by_id
        description: The Salesforce user that most recently updated the order record.

      - name: last_modified_date
        description: The timestamp at which the order record was most recently updated.

      - name: is_deleted
        description: '{{ doc("is_deleted") }}'

      - name: ignore_revenue_reallocation
        description: '{{ doc("ignore_revenue_reallocation") }}'  

      - name: includes_services
        description: '{{ doc("order_includes_services") }}'

      - name: includes_subscriptions
        description: '{{ doc("order_includes_subscriptions") }}'

      - name: has_invoices
        description: A boolean indicating whether the order has associated invoices.

      - name: count_of_invoices_created
        description: The count of invoices created against the order.

  - name: fct_salesforce_goals
    description: '{{ doc("fct_salesforce_goals") }}'
    columns:
      - name: daily_goal_id
        description: >
          A surrogate key built off of date, goal type, market segment, team, region, and touchpoint source.
        tests:
          - unique
          - not_null

      - name: goal_id
        description: A surrogate key built off of the quarter, goal type, market segment, team and region for a specific goal.

      - name: salesforce_goal_id
        description: The ID of the goal object in Salesforce.

      - name: created_by_id
        description: The ID of the user in Salesforce who created the goal.

      - name: last_modified_by_id
        description: The ID of the user in Salesforce who last modified the goal.

      - name: month_id
        description: >
          The ID of the month.
          This maps to the Month object in Salesforce.

      - name: quarter_id
        description: >
          The ID of the quarter.
          This maps to the Quarter object in Salesforce.

      - name: campaign_id
        description: The ID of the associated campaign in Salesforce that this goal applies to.

      - name: goal_name
        description: >
          The full name of the goal.
          This matches the Salesforce UI.

      - name: type
        description: >
          The type of the goal.
          Examples include: Leads, Pre-Pipeline, and Pipeline.

      - name: month_name
        description: >
          The month that the goal applies to.
          This is in the format: `YYYY-MM`

      - name: quarter_name
        description: >
          The fiscal quarter that the goal applies to.
          This is in the format: `YYYY-QQ`

      - name: team
        description: >
          The team this goal applies to (i.e. Alliances, Marketing, SDR Outbound).
          This is relevant for lead, pre-pipeline & pipeline goals.
          This maps to the `lead_source_type` in `fct_opportunities`.

      - name: region
        description: >
          The region this goal applies to (i.e. APAC, EMEA, US-East).
          This is relevant for lead, pre-pipeline & pipeline goals.

      - name: market_segment
        description: >
          The market segment this goal applies to (i.e. Commercial or Enterprise).
          This is relevant for lead, pre-pipeline & pipeline goals.

      - name: touchpoint_source
        description: >
          The touchpoint source this goal applies to (i.e. Contact Sales, Sign Ups).
          This is only relevant for lead & pipeline goals starting in Q3 2023 (August 1, 2022).

      - name: channel
        description: >
          The referring channel associated with a new Cloud Account.
          Actuals values are not yet being calculated at this grain, but goal values are reliable.
          Once attribution modeling is finalized, actuals for this goal will start to populate.
          We anticipate this will be available in early FY2024.

      - name: goal_amount
        description: >
          The total goal amount for each goal.
          Note - this value should not be summed since this dataset is broken out by day.
          This value should instead be treated as a dimension.

      - name: is_current_month
        description: A boolean field (true/false) that indicates if the goal values are for the current month.

      - name: is_current_quarter
        description: A boolean field (true/false) that indicates if the goal values are for the current fiscal quarter.

      - name: is_previous_month
        description: A boolean field (true/false) that indicates if the goal values are for the previous month.

      - name: is_previous_quarter
        description: A boolean field (true/false) that indicates if the goal values are for the previous fiscal quarter.

      - name: is_deleted
        description: Indicates if a goal has been deleted or not.

      - name: start_date
        description: >
          The first day the goal applies to.
          This should be the first day of the respective month.

      - name: end_date
        description: >
          The last day the gaol applies to.
          This should be the last day of the respective month.

      - name: quarter_start_date
        description: This first day of the respective fiscal quarter for the goal.

      - name: quarter_end_date
        description: This last day of the respective fiscal quarter for the goal.

      - name: created_date
        description: The day the goal was created.

      - name: last_modified_date
        description: When the goal was last modified.

      - name: date_day
        description: >
          The date the goal applies to.
          This should be combined with `daily_goal_amount` to find the goal value for that day.

      - name: total_days_in_months
        description: >
          Indicates how many days are in the respective month.
          This is used to calculate the `daily_goal_amount`.

      - name: daily_goal_amount
        description: >
          A calculated field that divides the `goal_amount` by `total_days_in_quarter`.
          This is useful if you want to measure the total goal to a specific date.
          In practice, this field should be summed to get an accurate value.
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: daily_forecast_amount
        description: >
          A calculated field that divides the `forecast_amount` by `total_days_in_quarter`.
          This is useful if you want to measure the total forecast to a specific date.
          In practice, this field should be summed to get an accurate value.

      - name: actual_amount
        description: >
          The actual amount of opportunities that were generated for a given segment.
          This currently contains lead counts, and pre-pipeline & pipeline opportunity counts.
          All touchpoints are counted for lead actuals.
          Opportunities of the type `Land` are counted for pre-pipeline actuals.
          Opportunities of the type `Land` where the `discover_at` date is not null are counted for pipeline actuals.
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: source_type
        description: >
          A temporary field that will allow the pipeline team to group the lead source associated with the opportunity into three specific groups: Demand Generation, Direct Demand, and Partner Referred Inbound.
          Once we implement our formal attribution model, this field will be replaced with the `channel_grouping` field from `fct_notion_channel_mapping`.

  - name: fct_account_license_seats
    description: >
      This model has the daily count of allocated seats in each salesforce 
      account. Opportunities must be close won before a seat is counted in
      this model.
    columns:
      - name: id
        tests:
          - unique
          - not_null

  - name: fct_touchpoints
    description: '{{ doc("fct_touchpoints") }}'
    columns:
      - name: touchpoint_id
        description: "The unique touchpoint id"
        tests:
          - unique
          - not_null

      - name: account_id
        description: '{{ doc("sfdc_account_id") }}'
        tests:
          - dbt_utils.relationships_where:
              to: ref('stg_salesforce__accounts')
              field: account_id
              from_condition: "last_modified_at <= dateadd(day,-1,current_date())"
              to_condition: "is_deleted = False and created_at <= dateadd(day,-1,current_date())"

      - name: campaign_id
        description: >
          The ID of the Salesforce campaign that created that touchpoint.
          This will only populate if the touchpoint was created as a part of a campaign.

      - name: contact_id
        description: "The Salesforce Contact id"
        tests:
          - dbt_utils.relationships_where:
              to: ref('stg_salesforce__contacts')
              field: contact_id
              from_condition: "last_modified_at <= dateadd(day,-1,current_date())"
              to_condition: "is_deleted = False and contact_created_at <= dateadd(day,-1,current_date())"

      - name: created_by_id
        description: "The id of the user who created the Touchpoint"

      - name: cloud_user_account_mapping_id
        description: "A lookup id to retrieve the Cloud user account from the dbt Cloud User Account object in Salesforce. NOTE: This is not the same as the dbt Cloud User Account id from our product."

      - name: cloud_account_mapping_id
        description: "A lookup id to retrieve the Cloud account from the dbt Cloud Account object in Salesforce. NOTE: This is not the same as the dbt Cloud Account id from our product."

      - name: cloud_user_mapping_id
        description: "A lookup id to retrieve the Cloud user from the dbt Cloud User object in Salesforce. NOTE: This is not the same as the dbt Cloud User id our product."

      - name: cloud_account_id
        description: >
          The dbt Cloud account ID associated with the touchpoint.
          Only certain touchpoints will provide this information, such as Sign Up.

      - name: cloud_user_id
        description: >
          The dbt Cloud user Id associated with the touchpoint.
          Only certain touchpoints will provide this information, such as Sign Up.

      - name: impartner_partner_account_id
        description: "Entered in Impartner; dbt Cloud Account ID associated with a Partner Project"

      - name: last_modified_by_id
        description: "The id of the user who last modified the touchpoint."

      - name: opportunity_id
        description: "The id of the opportunity associated with the touchpoint."
        tests:
          - dbt_utils.relationships_where:
              to: ref('stg_salesforce__opportunities')
              field: opportunity_id
              from_condition: "last_modified_at <= dateadd(day,-1,current_date())"
              to_condition: "created_at <= dateadd(day,-1,current_date())"

      - name: owner_id
        description: "The id of the user who owns the touchpoint. This is often the Sales Director (SD) or Sales Development Representative (SDR)."

      - name: parent_campaign_id
        description: >
          The ID of the parent Salesforce campaign that created that touchpoint.
          This will only populate if the touchpoint was created as a part of a campaign.

      - name: referred_by_partner_contact_id
        description: "The contact id of the partner that referred the touchpoint."

      - name: referred_by_partner_id
        description: "The partner id of the partner that referred the touchpoint."

      - name: zendesk_ticket_id
        description: "The id of the zendesk ticket that resulted in the touchpoint. This is derived from `Support Request` touchpoints."

      - name: campaign_name
        description: >
          The name of the Salesforce campaign that created that touchpoint.
          This will only populate if the touchpoint was created as a part of a campaign.

      - name: parent_campaign_name
        description: >
          The name of the parent Salesforce campaign that created that touchpoint.
          This will only populate if the touchpoint was created as a part of a campaign.
          
      - name: cloud_user_account_relationship
        description: A descriptor of the nature of a user's association with an account for this touchpoint.

      - name: impartner_deal_registration_status
        description: "Used in Impartner; Formula field that sets the Status to Approved, Pending, or Denied"

      - name: impartner_type_of_dbt_project
        description: "Entered in Impartner when impartner_type_of_registration is dbt Project; contains values of dbt Core and dbt Cloud"

      - name: impartner_type_of_registration
        description: "Entered in Impartner; Maps to Source and contains the values of dbt Project and dbt Cloud Enterprise sales referral"

      - name: message
        description: "An open text field that provides additional context to a touchpoint. This is only populated for touchpoints where open text is available, such as contact sales email, support request, and email introductions."

      - name: touchpoint_name
        description: "The touchpoint name derived from Salesforce. This follows the format of: L-#########"

      - name: touchpoint_source_detail
        description: "Additional detail that provides context to the touchpoint. An example includes the name of the Webinar that resulted in a Webinar touchpoint."

      - name: touchpoint_source_type
        description: "Synonymous with team: this is the team that is responsible for the touchpoint."

      - name: touchpoint_source
        description: "The source of the touchpoint. Examples include Contact Sales, Sign Up, SDR Outbound, etc."
        tests:
          - not_null

      - name: touchpoint_status
        description: "The current status of the touchpoint. Examples include New, Promoted, Working - Reached Out, and Archived."

      - name: is_deleted
        description: "A boolean field (true/false) that indicates if the touchpoint is deleted."

      - name: is_impartner_deal_registration
        description: "Set to true for Touchpoints that come in via Impartner"

      - name: is_impartner_deal_registration_denied
        description: "Used in Impartner; Manually checked if the partner team denies a Touchpoint entered by a Partner"

      - name: is_impartner_notify_partner
        description: "Used in Impartner; Set to true to trigger a notification to the partner"

      - name: is_qualified_touchpoint
        description: "A boolean field (true/false) that indicates if the touchpoint resulted in a contact becoming qualified."

      - name: created_at
        description: >
          A timestamp of when the touchpoint was created.
          Note: the majority of the time the `opened_at` field should be used when analyzing touchpoints overtime.
          This is because `opened_at` can be adjusted to correct touchpoint timestamps (such as when we load historical touchpoints).

      - name: last_activity_at
        description: "A timestamp of when the touchpoint was last active."

      - name: last_modified_at
        description: "A timestamp of when the touchpoint was last modified."

      - name: last_viewed_at
        description: "A timestamp of when the touchpoint was last viewed."

      - name: last_referenced_at
        description: "A timestamp of when the touchpoint was last referenced."

      - name: opened_at
        description: >
          A timestamp indicated when the touchpoint was opened.
          This is the standard field that should be used when analyzing touchpoints for a given timeframe.
          This field is different than `created_at` in that it can be adjusted after the fact, resulting in more accurate values.

      - name: qualified_at
        description: >
          A timestamp indicated when the touchpoint resulted in a qualified contact.
          This field is a combination of the `opened_at` field and the `is_qualified_touchpoint` field.

      - name: system_modstamp
        description: "A timestamp indicating when the recorded was last modified by a user or an automated process."

      - name: touchpoint_index
        description: >
          The Nth touchpoint for a given contact.
          Index starts at 1.
          This should be read as, any touchpoint with `touchpoint_index=1` is the contact's first touchpoint.

      - name: previous_touchpoint_opened_at
        description: >
          The `opened_at` timestamp for the contact's previous touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing the time difference between the two.
          This can also be used in aggregated to find the average time it takes to go from one touchpoint to another.

      - name: previous_touchpoint_source
        description: >
          The `touchpoint_source` for the contact's previous touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing what touchpoint occured before it.
          This can also be used in aggregate to see which touchpoint sources commonly precede another.

      - name: previous_touchpoint_source_detail
        description: >
          The `touchpoint_source_detail` for the contact's previous touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing what touchpoint occured before it.
          This can also be used in aggregate to see which touchpoint source details commonly precede another.

      - name: previous_touchpoint_source_type
        description: >
          The `touchpoint_source_type` for the contact's previous touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing what touchpoint occured before it.
          This can also be used in aggregate to see which touchpoint source types commonly precede another.

      - name: next_touchpoint_opened_at
        description: >
          The `opened_at` timestamp for the contact's next touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing the time difference between the two.
          This can also be used in aggregated to find the average time it takes to go from one touchpoint to another.

      - name: next_touchpoint_source
        description: >
          The `touchpoint_source` for the contact's next touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing what touchpoint occured before it.
          This can also be used in aggregate to see which touchpoint sources commonly follow another.

      - name: next_touchpoint_source_detail
        description: >
          The `touchpoint_source_detail` for the contact's next touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing what touchpoint occured before it.
          This can also be used in aggregate to see which touchpoint source details commonly follow another.

      - name: next_touchpoint_source_type
        description: >
          The `touchpoint_source_type` for the contact's next touchpoint.
          This is useful if you are looking at a specific touchpoint and are interested in seeing what touchpoint occured before it.
          This can also be used in aggregate to see which touchpoint source types commonly follow another.

      - name: first_touchpoint_opened_at
        description: >
          The `opened_at` timestamp for the contact's first touchpoint.
          This is useful if you are looking understand when a contact's first touchpoint occured.
        tests:
          - dbt_utils.expression_is_true:
              expression: "= opened_at"
              config:
                where: "touchpoint_index = 1"

      - name: first_touchpoint_source
        description: >
          The `touchpoint_source` for the contact's first touchpoint.
          This is useful if you are looking understand a contact's first touchpoint source.

      - name: first_touchpoint_source_detail
        description: >
          The `touchpoint_source_detail` for the contact's first touchpoint.
          This is useful if you are looking understand a contact's first touchpoint source detail.

      - name: first_touchpoint_source_type
        description: >
          The `touchpoint_source_type` for the contact's first touchpoint.
          This is useful if you are looking understand a contact's first touchpoint source type.

      - name: last_touchpoint_opened_at
        description: >
          The `opened_at` timestamp for the contact's last touchpoint.
          This is useful if you are looking understand when a contact's most recent touchpoint occured.
        tests:
          - dbt_utils.expression_is_true:
              expression: "= opened_at"
              config:
                where: "is_most_recent_touchpoint = True"

      - name: last_touchpoint_source
        description: >
          The `touchpoint_source` for the contact's last touchpoint.
          This is useful if you are looking understand a contact's most recent touchpoint source.

      - name: last_touchpoint_source_detail
        description: >
          The `touchpoint_source_detail` for the contact's last touchpoint.
          This is useful if you are looking understand a contact's most recent touchpoint source detail.

      - name: last_touchpoint_source_type
        description: >
          The `touchpoint_source_type` for the contact's last touchpoint.
          This is useful if you are looking understand a contact's most recent touchpoint source type.

      - name: is_hand_raise_event
        description: >
          A boolean field that indicates if a touchpoint is considered a hand raise event.
          Hand raise events are specific touchpoints that indicate that the contact is ready to begin the sales process.
          Currently, these touchpoint sources are considered hand raise events:
          `Contact Sales`, `Support Request`, `Contact Sales Email`, `Email Introduction`, `Community Introduction`, 
          `Partner - Existing Partner Customer`, `Partner - Joint Coselling Opportunity`, `dbt Cloud Enterprise sales referral`

      - name: is_most_recent_touchpoint
        description: A boolean field that indicates if a touchpoint is the most recent touchpoint for a given contact.

      - name: project_registration_type
        description: >
          The type of project for touchpoints with the source `dbt Project Registration Form`.
          Values include: `dbt Core`, `dbt Cloud`, and `development support`

      - name: market_segment
        description: >
          The market segment that the account associated with the touchpoint is in.
          Examples include: Commercial & Enterprise.

      - name: region
        description: >
          The region that the account associated with the touchpoint is in.
          Examples include: US-East, US-West, US-Central, EMEA, and APAC.

  - name: dim_salesforce_users
    description: >
      This model has all users from salesforce and their associated manager.
    columns:
      - name: user_id
        description: ""
        tests:
          - unique
          - not_null

      - name: name
        description: "The user's full name"

      - name: user_role
        description: "The user's assigned role in Salesforce"

      - name: username
        description: "The salesforce username of the user "

      - name: alias
        description: "The salesforce alias of the user"

      - name: email
        description: "The email of the user"

      - name: manager_id
        description: "The id of the user's manager"

      - name: manager_name
        description: "The user's manager's name"

      - name: manager_role
        description: "The role of user's manager"

      - name: is_manager
        description: "A boolean field that indicates if user is a manager of another user(s)"

      - name: is_active
        description: "A boolean field that indicates whether user is active in Salesforce"

      - name: created_at
        description: "A timestamp of when user was created in Salesforce"

  - name: fct_salesforce__rep_quota_periods_forecast
    description: >
      This model has the monthly quotas and forecasted amounts for each salesperson.
      Quotas are derived from Xactly and actual/forecasted amounts are derived from opportunities.
    columns:
      - name: salesperson_commission_id
        description: "The unique identifier of sales_person_user_id and commission_start_date"
        tests:
          - unique
          - not_null

      - name: sales_person_user_id
        description: "The salesforce sales person id"

      - name: sales_person_name
        description: "The full name of the sales person"

      - name: commission_period_start_date
        description: "The date in which the commission period started. This is the first of the month."

      - name: commission_period_end_date
        description: "The date in which the commission period ended. This is the end of the month."

      - name: total_quota
        description: "The full quota for the salesperson in the commission period. This quota contains a 5% buffer for renewals."

      - name: new_arr_quota
        description: "The new arr (land) quota for the sales person in the commission period."

      - name: renewal_quota
        description: "The renewal (renew) quota for the sales person in the commission period."

      - name: total_commissionable_arr
        description: "The total amount of arr counted for the commission period."

      - name: total_delta_arr
        description: "The closed net arr for the commission period."

      - name: total_opp_commissions
        description: "The total amount of opportunities that led to commissions."

      - name: total_rep_delta_arr
        description: "The total amount of arr split for reps."

      - name: total_services_revenue
        description: "The total amount of revenue from services that are not arr (onboarding, training, etc)."

      - name: total_opp_end_arr
        description: "The total ending ARR for the commission period"

      - name: total_opp_delta_arr
        description: "The total amount of net arr derived from the opportunities. This can be closed or open."

      - name: total_opp_discover_at_delta_arr
        description: "The total expected contract value at the Discover phase."

      - name: total_opp_expected_arr_delta
        description: "The total expected net arr. This is calculated by multiplying opportunity probability and expected contract value."

      - name: ramping_quota_no_churn_disc
        description: "Ramping quota for a salesperson without churn discount for renewals"

      - name: fully_ramped_quota_no_churn_disc
        description: "Fully ramped quota for a salesperson without a churn discount for renewals"

      - name: fiscal_half_year_commission_period_start_date
        description: "The fiscal half year based on the commission period start date."

  - name: fct_xactly_credits
    description: >
      Collapsed Xactly credits to monthly grain, using SFDC Opp close date when
      appropriate or data sourced from Xactly.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - salesforce_user_id
            - salesforce_opportunity_id
            - credit_type_id
            - period_started_at
          where: is_sfdc_credit = true
    columns:
      - name: period_started_at
        description: The month the credit is applied to.
        tests:
          - not_null